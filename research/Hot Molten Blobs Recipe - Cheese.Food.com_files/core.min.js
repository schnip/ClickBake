"undefined"==typeof FD&&(FD={}),"undefined"==typeof SNI&&(SNI={}),SNI.Config||(SNI.Config={}),SNI.Community||(SNI.Community={}),SNI.Community.UR||(SNI.Community.UR={});var gigya;Date.prototype.addDays||(Date.prototype.addDays=function(days){return this.setDate(this.getDate()+days),this}),Date.prototype.clearTime||(Date.prototype.clearTime=function(){return this.setHours(0,0,0,0),this}),Date.prototype.isSameDay||(Date.prototype.isSameDay=function(compareDate){return this.clearTime(),compareDate.clearTime(),this.getTime()==compareDate.getTime()}),String.prototype.format||(String.prototype.format=function(){var pattern=/\{\d+\}/g,args=1==arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments;return this.replace(pattern,function(capture){return args[capture.match(/\d+/)]})}),String.prototype.padLeft||(String.prototype.padLeft=function(padChar,length){var str=this,len=str.length,pad=[];if(str.length<length)for(;pad.length+len<length;)pad.push(padChar);return pad.join("")+str}),String.prototype.startsWith||(String.prototype.startsWith=function(pattern,flag){var pattern,len=pattern.length;return this.length<len?!1:null!==this.substr(0,len).match(new RegExp(pattern,flag))}),String.prototype.endsWith||(String.prototype.endsWith=function(pattern,flag){var len=pattern.length;return this.length<len?!1:null!==this.substr(this.length-len,len).match(new RegExp(pattern,flag))}),String.prototype.contains||(String.prototype.contains=function(pattern,flag){return null!==this.match(new RegExp(pattern,flag))}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this.toLowerCase().replace(/\b[a-z]/g,function(letter){return letter.toUpperCase()})}),String.prototype.strip||(String.prototype.strip=function(){return this.trim().replace(/[^\w\s]/g,"").replace(/\s/g,"-").replace(/-+/g,"-")}),String.prototype.toRegExp||(String.prototype.toRegExp=function(){var chars=this.split(""),specialChars=[".","+","{","}","[","]","?","$","^","*","\\","(",")"],pattern=chars.map(function(c){return specialChars.contains(c)?"\\"+c:c});return new RegExp(pattern.join(""),"gi")}),String.prototype.Trim||(String.prototype.Trim=function(pattern){if(pattern){var re="object"==typeof pattern?pattern:new RegExp(pattern,"g");return this.replace(re,"")}return this.replace(/^\s+|\s+$/,"")}),String.prototype.crunch||(String.prototype.crunch=function(pattern){return this.replace(/\s/g,pattern||"")}),String.prototype.toTitleCase||(String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}),String.prototype.toLocaleNumberFormat||(Number.prototype.toLocaleNumberFormat=function(){return this.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}),String.prototype.toCamelCase||(String.prototype.toCamelCase=function(){return this.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()})}),String.prototype.toURIComponent||(String.prototype.toURIComponent=function(){var str=this,arr=str.split(" "),arrEncoded=$.map(arr,function(word){return encodeURIComponent(word)});return arrEncoded.join("+")}),String.prototype.render||(String.prototype.render=function(data){var key,val,re,str=this;if(data&&"object"==typeof data)for(key in data)val=data[key],re=("{{"+key+"}}").toRegExp(),str=str.replace(re,val);return str}),Array.isArray||(Array.isArray=function(arg){return"[object Array]"===Object.prototype.toString.call(arg)}),Array.prototype.filter||(Array.prototype.filter=function(fun){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisArg=arguments.length>=2?arguments[1]:void 0,i=0;len>i;i++)if(i in t){var val=t[i];fun.call(thisArg,val,i,t)&&res.push(val)}return res}),Array.prototype.contains||(Array.prototype.contains=function(fn){var t=Object(this),res=t.filter(function(item){return item==fn});return res.length>0}),Array.prototype.findIndex||(Array.prototype.findIndex=function(predicate){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;length>i;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return i;return-1}),Function.prototype.debounce=function(threshold,execAsap){var timeout,func=this;return function(){function delayed(){execAsap||func.apply(obj,args),timeout=null}var obj=this,args=arguments;timeout?clearTimeout(timeout):execAsap&&func.apply(obj,args),timeout=setTimeout(delayed,threshold||100)}},debug=!1,debug_message=function(){window.log(arguments)},"undefined"==typeof log&&(window.log=function(){log.history=log.history||[],log.history.push(arguments),this.console&&this.console.log&&debug&&console.log(Array.prototype.slice.call(arguments))}),window.viewLog=function(){var i,history=log.history||[];if(history.length)for(i=0;i<history.length;i++)this.console&&this.console.log&&console.log(history[i]);else this.console&&this.console.log&&console.log("...no debug history...")},window.ensureNamespace=function(namespace){var i,level,levels=namespace.trim().split("."),obj=window;for(i=0;i<levels.length;i++)if(level=levels[i],"undefined"==typeof obj[level]&&(obj[level]={}),obj=obj[level],"object"!=typeof obj||$.isArray(obj))return!1;return!0},function(w,d,$){w.lateLoad=function(url,id,callback,data){$(w).bind("load",function(){var js,fjs=d.getElementsByTagName("script")[0];d.getElementById(id)||(js=d.createElement("script"),js.src=url,js.id=id,callback&&$(js).bind("load",function(){callback.call(this,data)}),fjs.parentNode.insertBefore(js,fjs))})}}(window,document,jQuery),SNI.MetaData={},SNI.MetaData.Parameter=function(){var parameters={};this.addParameter=function(key,value){key=key.toUpperCase(),parameters[key]||(parameters[key]=[]),parameters[key].push(value)},this.getParameter=function(key,separator){return key=key.toUpperCase(),parameters[key]?parameters[key].join(separator):void 0},this.getKeys=function(){return parameters},this.setParameter=function(key,value){key=key.toUpperCase(),parameters[key]=[],parameters[key].push(value)},this.resetKeys=function(){parameters={}}},SNI.MetaData.Manager=function(){var m=new SNI.MetaData.Parameter;this.addParameter=m.addParameter,this.getParameter=m.getParameter,this.getKeys=m.getKeys,this.setParameter=m.setParameter,this.resetKeys=m.resetKeys,this.getParameterString=function(key){var s=this.getParameter(key," ");return null==s&&(s=""),s},this.getPageType=function(){return this.getParameterString("Type")},this.getPageTitle=function(){return this.getParameterString("Title")},this.getSite=function(){return this.getParameterString("Site")},this.getSctnId=function(){return this.getParameterString("SctnId")},this.getSctnName=function(){return this.getParameterString("SctnName")},this.getSponsorship=function(){return this.getParameterString("Sponsorship")},this.getAbstract=function(){return this.getParameterString("Abstract")},this.getKeywords=function(){return this.getParameterString("Keywords")},this.getClassification=function(){return this.getParameterString("Classification")},this.getSctnDspName=function(){return this.getParameterString("SctnDspName")},this.getCategoryDspName=function(){return this.getParameterString("CategoryDspName")},this.getShowAbbr=function(){return this.getParameterString("Show_Abbr")},this.getRole=function(){return this.getParameterString("Role")},this.getDetailId=function(){return this.getParameterString("DetailId")},this.getPageNumber=function(){return this.getParameterString("PageNumber")},this.getUniqueId=function(){return this.getParameterString("UniqueId")},this.getUserId=function(){return this.getParameterString("UserId")},this.getUserIdEmail=function(){return this.getParameterString("UserIdEmail")},this.getUserIdCreateDt=function(){return this.getParameterString("UserIdCreateDt")},this.getUserIdVersion=function(){return this.getParameterString("UserIdVersion")},this.getFilters=function(){return this.getParameterString("Filters")},this.getMultimediaFlag=function(){return this.getParameterString("MultimediaFlag")},this.getChefName=function(){return this.getParameterString("ChefName")},this.getMealPart=function(){return this.getParameterString("MealPart")},this.getCuisine=function(){return this.getParameterString("Cuisine")},this.getOccasion=function(){return this.getParameterString("Occasion"," ")},this.getMainIngredient=function(){return this.getParameterString("MainIngredient")},this.getTechnique=function(){return this.getParameterString("Technique"," ")},this.getDish=function(){return this.getParameterString("Dish"," ")},this.getMealType=function(){return this.getParameterString("MealType"," ")},this.getNutrition=function(){return this.getParameterString("Nutrition"," ")},this.getDifficulty=function(){return this.getParameterString("Difficulty"," ")},this.getPrepTime=function(){return this.getParameterString("PrepTime")},this.getSearchTerm=function(){var args=parseQueryString();for(var arg in args){var s=arg.toUpperCase();if("SEARCHSTRING"==s)return args[arg]}return""},this.setMultimediaFlag=function(flag){null!=flag?this.addParameter("MultimediaFlag",flag):this.addParameter("MultimediaFlag","")},this.parseQueryString=function(str){str=str?str:document.location.search;var query="?"==str.charAt(0)?str.substring(1):str,args={};if(query)for(var fields=query.split("&"),f=0;f<fields.length;f++){var field=fields[f].split("=");args[unescape(field[0].replace(/\+/g," "))]=unescape(field[1].replace(/\+/g," "))}return args}};var MetaDataManager=SNI.MetaData.Manager;"undefined"==typeof mdManager&&(mdManager=new MetaDataManager),function($){"undefined"==typeof FD&&(FD={});var fd={getEnvironment:function(){return FD.Config.MetaData.environment},environmentIs:function(env){return this.getEnvironment()==env},isDev:function(){return this.environmentIs("development")},isStage:function(){return this.environmentIs("staging")},isProd:function(){return this.environmentIs("production")}};$.extend(!0,FD,fd)}(jQuery),function($){"undefined"==typeof FD&&(FD={}),FD.Util={exists:function(value){var isUndefined=void 0===value,isNull=null===value,isEmpty=""===value;return!(isUndefined||isNull||isEmpty)},isLoggedIn:function(){var user={};return"undefined"!=typeof userInfo&&(user=userInfo),user.userId?!0:!1},isValidEmail:function(email){var re=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return re.test(email)},loadImage:function(imgSrc){if(imgSrc){var img=new Image;return img.src=imgSrc,img}},getDomain:function(initialPath){var port=location.port,protocol=location.protocol,host=location.hostname,isSSL=protocol.startsWith("https");return(isSSL&&443!==port||!isSSL&&"80"!=port)&&(host+=":"+port),host.contains("localhost")&&(host+=initialPath||"/RZWeb"),protocol+"//"+host},getServiceDomain:function(){var host=location.hostname;return host.contains("localhost")?FD.Util.getDomain("/FoodServices"):FD.Util.getDomain("/services")},getUserGeoLocation:function(successCallback,errorCallback){"undefined"==typeof successCallback&&(successCallback=function(position){log("Latitude: "+position.coords.latitude+" - Longitude: "+position.coords.longitude)}),"undefined"==typeof errorCallback&&(errorCallback=function(error){switch(error.code){case error.PERMISSION_DENIED:log("UserLocation: User denied the request for Geolocation.");break;case error.POSITION_UNAVAILABLE:log("UserLocation: Location information is unavailable.");break;case error.TIMEOUT:log("UserLocation: The request to get user location timed out.");break;case error.UNKNOWN_ERROR:log("UserLocation: An unknown error occurred.")}}),navigator.geolocation?navigator.geolocation.getCurrentPosition(successCallback,errorCallback):log("UserLocation: Geolocation is not supported by this browser.")},exitBeta:function(){$.removeCookie("layout",{path:"/",domain:SNI.Config.cookieDomain}),$.removeCookie("beta_exp_optout"),$.cookie("beta_exp_optout","true",{path:"/",expires:"",domain:SNI.Config.cookieDomain}),$(window).scrollTop(0),window.location.reload()},isGigyaEnabled:function(){return!0},closePushdown:function(){var $pushdown=$(".pushdown-message");$pushdown.slideUp(),$.cookie("fdc.shinny.msg","true",{expires:365,path:"/",domain:FD.Config.cookieDomain})},openPushdown:function(){var pd=$(".pushdown-message"),content=pd.html().trim();null===$.cookie("fdc.shinny.msg")&&""!=content&&$(".pushdown-message").removeClass("hidden")}},$(function(){$(document).on("click","*[data-expandable]",function(e){var cTarget=$(e.currentTarget);return console.log("expanding..."),cTarget.toggle(),$(cTarget.data("expandable")).toggle(),!1})})}(jQuery),function($){var page={Page:{getUniqueId:function(idLength){var id="",chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_";idLength||(idLength=8);for(var i=0;idLength>i;i++)id+=chars.charAt(Math.floor(Math.random()*chars.length));return id},setMetaTag:function(attributes){var prop=attributes.name?'[name="'+attributes.name+'"]':'[property="'+attributes.property+'"]',meta=$("meta"+prop);return 0==meta.length&&(meta=$("<meta/>").appendTo("head")),meta.attr(attributes),meta},setLinkTag:function(attributes){var val=$.trim(attributes.rel||""),link=$('link[rel="'+val+'"]');return(0==val.length||0==link.length)&&(link=$("<link/>").appendTo("head")),link.attr(attributes),link},canonicalUrl:function(newUrl){var page=this,link=$('link[rel="canonical"]'),linkExists=!!link.length,url=newUrl||document.location.href;return linkExists&&!newUrl?link.attr("href"):(link=page.setLinkTag({rel:"canonical",href:newUrl||url}),url)},title:function(newTitle){var $ttl=$("title"),title="Food.com - Thousands Of Free Recipes From Home Chefs With Recipe Ratings, Reviews And Tips";return 0==$ttl.length&&($ttl=$("<title></title>").text(title).appendTo("head")),newTitle&&$ttl.text(newTitle),$ttl.text()},viewport:function(option){var dim={width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)};switch(option){case"width":return dim.width;case"height":return dim.height}return dim},htmlEncode:function(){var el=document.createElement("div");return function(str){return el.innerText=el.textContent=str,str=el.innerHTML}}(),htmlDecode:function(){function decode(str,stripTags,stripScriptTags){return str&&"string"==typeof str&&(element.innerHTML=str,str=element.innerText||element.textContent,(stripTags||stripScriptTags)&&(str=str.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),str=str.replace(/\&lt\;script[^\&gt\;]*\&gt\;([\S\s]*?)\&lt\;\/script\&gt\;/gim,"")),stripTags&&(str=str.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),str=str.replace(/\&lt;\/?\w(?:[^"'\&gt;]|"[^"]*"|'[^']*')*\&gt;/gim,"")),element.innerHTML=str,str=element.innerText||element.textContent,element.innerHTML=""),str}var element=document.createElement("div");return decode}(),encodeRegExChar:function(c){var schars={"\\":"&#92;","^":"&#94;",$:"&#36;",".":"&#46;","|":"&#124;","?":"&#63;","*":"&#42;","+":"&#43;","(":"&#40;",")":"&#41;","[":"&#91;","{":"&#123;"};return schars[c]?schars[c]:c},getAdType:function(slot){var adtype=slot&&slot.slot&&(slot.slot.b&&(slot.slot.b.d||slot.slot.b.f)||slot.slot.l&&slot.slot.l.m)||null;return adtype||log("ERROR! FD.Page.getAdType() was not able to get the ad type; most likely the slot object structure changed again."),adtype},type:function(){var pageType=mdManager.getParameter("TYPE");if("undefined"!=typeof pageType)return pageType;var si=setInterval(function(){pageType=mdManager.getParameter("TYPE"),pageType&&(FD.Page.type=pageType,clearInterval(si))},200);return""}()}};"undefined"==typeof FD&&(FD={}),FD=$.extend(!0,FD,page),$(function(){FD.subscribe("fd.results.nextpage",function(pageNo){if(log("...fire page view for search: page "+pageNo),"1"!=pageNo){if("undefined"!=typeof mdManager){var uniqueId=mdManager.getParameter("uniqueId");log("uniqueId: "+uniqueId)}FD.publish("fd.omniture.pageview.fire",[])}}),FD.subscribe("fd.omniture.pageview.fire",function(url,uniqueId){log("...fire page view"),"undefined"!=typeof s&&("undefined"!=typeof mdManager&&(mdManager.setParameter("Site Tier","scrolled"),"undefined"!=typeof url&&""!==url&&mdManager.setParameter("url",url),"undefined"!=typeof uniqueId&&""!==uniqueId&&mdManager.setParameter("UniqueId",uniqueId)),s.t())})})}(jQuery),"undefined"!=typeof jQuery&&function($){function Url(url){var me=this;me.originalUrl=url||document.location.toString(),"object"==typeof url?$.extend(me,url):me.setUrl()}Url.prototype.setUrl=function(){var me=this,a=document.createElement("a");me.originalUrl.startsWith("//")&&(me.originalUrl=location.protocol.Trim(":")+me.originalUrl),a.href=me.originalUrl;var getValue=function(str){return""+(str||"")};me.protocol=getValue(a.protocol),me.host=getValue(a.hostname),me.port=getValue(a.port),me.path=getValue(a.pathname),me.path.startsWith("/")||(me.path="/"+me.path),me.querystring=new FD.Url.QueryString(getValue(a.search)),me.hash=getValue(a.hash),me.origin=getValue(a.origin),a=null},Url.prototype.toString=function(isRelative){var me=this,relative=""+me.path+me.querystring.toString()+me.hash;return isRelative?relative:""+me.protocol+"//"+me.host+me.getPort()+relative},Url.prototype.ajaxGet=function(dataType){var me=this;return{url:""+me.protocol+"//"+me.host+me.getPort()+me.path,type:"get",datatype:dataType||"json",data:me.querystring.data}},Url.prototype.getPort=function(){var me=this;return me&&me.port&&me.port.length>0&&"0"!=me.port?":"+me.port:""},Url.prototype.setQueryString=function(querystring){var me=this;me.querystring=querystring},"undefined"==typeof window.FD&&(FD={}),$.extend(!0,FD,{Url:Url})}(jQuery),function($){function QueryString(querystring,encodeURIComponents){var me=this;me.encodeURIComponents="undefined"==typeof encodeURIComponents||!!encodeURIComponents,me.original="string"==typeof querystring?querystring&&querystring.Trim("\\??|\\&?"):querystring||"",me.data="object"==typeof querystring?$.extend({},querystring):me.original.length?me.decodeValues(me.original):{}}QueryString.prototype.decodeValues=function(querystring){var kvPair=querystring.split("&"),qs={};return $.each(kvPair,function(i,pair){var parts=pair.split("=");qs[parts[0]]=decodeURIComponent(parts[1])||""}),qs},QueryString.prototype.add=function(params){var key,me=this;for(key in params)me.val(key,params[key])},QueryString.prototype.val=function(key,value){var me=this;if(value)me.data[key]=decodeURIComponent(value);else if(null===value)return void delete me.data[key];return me.data[key]||null},QueryString.prototype.encodeValue=function(val){return this.encodeURIComponents?encodeURIComponent(""+val).replace(/%2B/g,"+"):val},QueryString.prototype.encodeValueArray=function(arr,joinVal){var value,me=this,len=arr&&arr.length;if(arr.length>0){for(i=0;i<len;i++)value=arr[i],arr[i]=me.encodeValue(value);return arr.join(joinVal||",")}return""},QueryString.prototype.toString=function(){var key,value,splitVal,me=this,data=me.data,qs=[];for(key in data)value=data[key],Array.isArray(value)?value=me.encodeValueArray(value):(splitVal=value.split(" "),value=splitVal.length>1?me.encodeValueArray(splitVal,"+"):me.encodeValue(value)),qs.push(key+"="+value);return qs.length>0?"?"+qs.join("&"):""},window.FD||(FD={}),FD.Url.QueryString=QueryString}(jQuery),"undefined"==typeof window.FD&&(window.FD={}),function($){function PubSub(){var cache={};this.publish=function(topic,args){if(cache[topic]){var eventName=topic;$.each(cache[topic],function(){if($.isArray(args)||(args=[args]),"function"==typeof this)this.apply($,args||[]);else{var msg='FD.publish encountered an issue where a function was not set properly for the "{0}" event.';log(msg.format(eventName))}})}},this.subscribe=function(topic,callback){return cache[topic]||(cache[topic]=[]),cache[topic].push(callback),[topic,callback]},this.unsubscribe=function(handle){var t=handle[0];cache[t]&&$.each(cache[t],function(idx){this==handle[1]&&cache[t].splice(idx,1)})}}var pubsub=new PubSub;$.extend(!0,FD,pubsub)}(jQuery,FD),window.FD||(window.FD={}),function(){window.History&&(FD.History={push:function(stateData,title,seoUrl){this.isNavEvent=!1,stateData&&title&&seoUrl&&window.History.pushState(stateData,title,seoUrl)},replace:function(stateData,title,seoUrl){this.isNavEvent=!1,stateData&&title&&seoUrl&&window.History.replaceState(stateData,title,seoUrl)},stateChanged:function(event,state){FD.publish(event,[state])},isNavEvent:!0},window.History.Adapter.bind(window,"statechange",function(){FD.History.isNavEvent?FD.History.stateChanged("History.statechange",window.History.getState()):FD.History.isNavEvent=!0}))}(),function($){function Typeahead(element,options){var me=this,defaults={cssClass:{error:"fdc-error-msg",warning:"fdc-warning-msg",selected:"selected"},cssSelectors:{typeahead:".typeahead",taList:".ta-list",listTitle:".list-title",selected:".selected",suggContainer:"ul",suggestion:"li",searchForm:".fd-search form"},errors:{noSearchTerm:"Please enter a search term.",searchTermLength:"Please enter at least 3 consecutive letters.",noSuggestions:"No suggestions found."},dataSources:{cookie:"fd-recentlyViewed",searchSuggest:{url:FD.Config.apiServerURL+"/services/mobile/fdc/suggest/search",type:"json"},editorial:{url:FD.Config.apiServerURL+"/services/mobile/fdc/suggest/popular",type:"json"}},demo:!1};me.settings=$.extend(!0,{},defaults,options||{}),me.searchBox=element||$(me.settings.cssSelectors.typeahead),me.taList=me.searchBox.find(me.settings.cssSelectors.taList),me.searchField=me.searchBox.find('input:not([type="hidden"])'),me.searchBtn=me.searchBox.find(".btn");var id=me.searchBox.attr("id");id||(id="fd-typeahead-"+FD.Page.getUniqueId(),me.searchBox.attr("id",id)),me.selectEventName=id+".select",me.searchBtn.length||(me.searchBtn=me.searchBox.siblings(".btn")),me.lastTerm=null,me.settings.clearCache&&me.clearCache(),me.setEventListeners()}var cache={};Typeahead.prototype.cancel=function(){this.clear(),this.searchField.val(""),this.searchField.is(":focus")&&this.searchField.blur()},Typeahead.prototype.clear=function(){this.taList.hide()},Typeahead.prototype.setEventListeners=function(){function setTimer(milliseconds){timer||(timer=setTimeout(function(){me.cancel()},250))}var me=this,settings=me.settings,selectors=settings.cssSelectors,classes=settings.cssClass,timer=null;me.searchBtn.on("click",function(e){me.taList.hide(),me.select()}),me.searchBox.on("click",selectors.suggestion,function(e){e.preventDefault(),e.stopPropagation();var link=$(this),term=link.text();me.searchField.val(term),me.select()}).on("mouseover",selectors.suggestion,function(e){var $sugg=$(this);$sugg.siblings(selectors.suggestion).removeClass(classes.selected),$sugg.addClass(classes.selected)}).on("keydown",function(e){var key=($(this),e.charCode||e.keyCode),isKey=$.ui.keyCode;switch(key){case isKey.ENTER:e.preventDefault();var selected=me.taList.find(".selected").text();return selected&&me.searchField.val()!==selected?me.searchField.val(selected):(me.taList.hide(),me.searchBtn.trigger("click")),me.select(),!0;case isKey.ESCAPE:return me.cancel(),!1;case isKey.UP:return e.preventDefault(),me.selectSuggestion(-1),!0;case isKey.DOWN:return me.selectSuggestion(1),!0;default:return!0}}).on("keyup",function(e){var isKey=$.ui.keyCode;e.keyCode!=isKey.UP&&e.keyCode!=isKey.DOWN&&me.getData()}).on("focusin",function(){clearTimeout(timer),timer=null,me.searchField.trigger("keyup")}).on("focusout",function(e){$(this).find(".ta-list:visible").length>0&&setTimer()}).on("mouseover",".ta-list",function(e){clearTimeout(timer),timer=null}).on("mouseout",".ta-list",function(e){me.searchField.is(":focus")||setTimer()}),FD.subscribe("FD.Header.CancelSearch",function(){me.cancel()})},Typeahead.prototype.select=function(){FD.publish(this.selectEventName,[this])},Typeahead.prototype.selectSuggestion=function(dir){log("::selectSuggestion::"+dir);var selectedItem,selectedIdx,nextIdx,nextItem,isSelected,inRange,me=this,selectors=me.settings.cssSelectors,classes=me.settings.cssClass,visibleItems=me.taList.find(selectors.suggestion+":visible"),isNext=dir>0;visibleItems.each(function(){var li=$(this);li.is(selectors.selected)&&(selectedItem=li)}),isSelected="undefined"!=typeof selectedItem&&selectedItem.length>0,selectedIdx=isSelected?visibleItems.index(selectedItem):-1,selectedItem=visibleItems.eq(selectedIdx),nextIdx=selectedIdx+dir,inRange=nextIdx>=0&&nextIdx<visibleItems.length,nextItem=isSelected&&inRange?visibleItems.eq(nextIdx):isNext?visibleItems.first():visibleItems.last(),nextItem.addClass(classes.selected).siblings().removeClass(classes.selected),me.scrollToSelected()},Typeahead.prototype.scrollToSelected=function(){var me=this,selector=me.settings.cssSelectors,scrollPosition=me.taList.scrollTop(),selectedItem=me.taList.find(selector.selected),selectedPosition=selectedItem.position().top,selectedHeight=selectedItem.outerHeight(!0),listHeight=me.taList.height(),scrollTo=selectedPosition+scrollPosition+selectedHeight-listHeight;me.taList.scrollTop(scrollTo>0?scrollTo:0)},Typeahead.prototype.filterSuggestions=function(){var $visibleItems,me=this,selectors=me.settings.cssSelectors,classes=me.settings.cssClass,$typeaheadList=me.searchBox.find(selectors.taList),$suggestions=$typeaheadList.find(selectors.suggestion).removeClass(classes.selected).hide(),searchVal=me.searchField.val();$suggestions.each(function(index){var suggFrag,$suggestion=$(this),suggText=$suggestion.text(),suggMatch=suggText&&suggText.startsWith(searchVal,"i");suggMatch&&($suggestion.show(),suggFrag=suggText.substr(0,searchVal.length),suggText=suggText.replace(suggFrag,"<em>"+suggFrag+"</em>"),$suggestion.html(suggText))}),$typeaheadList.show(),$visibleItems=$suggestions.filter(":visible"),$suggestions.is(":visible")?$visibleItems.length>10&&$visibleItems.eq(9).nextAll().hide():$typeaheadList.hide()},Typeahead.prototype.clearCache=function(){cache={}},Typeahead.prototype.showResults=function(results,title){function addSuggestions(){var $container=$list.find(selectors.suggContainer),$items=$container.find(selectors.suggestion);$items.remove(),$.each(results,function(i,v){var val=v,li=$("<li></li>");"object"==typeof val&&(val=v.name),$container.append(li.html(val))}),$items=$container.find(selectors.suggestion),$items.length>10&&$items.eq(9).nextAll().hide()}var me=this,selectors=me.settings.cssSelectors,$list=me.searchBox.find(selectors.taList),$listTitle=$list.find(selectors.listTitle);results&&($listTitle.hide(),addSuggestions(results),me.filterSuggestions()),title&&$listTitle.text(title).show(),$list.scrollTop(0)},Typeahead.prototype.getDataSource=function(){var me=this,val=(me.settings.dataSources,me.searchField.val()),valLength=val.length;return me.recentlyViewed=JSON.parse(me.getListFromCookie()),valLength>=3?"searchSuggest":"editorial"},Typeahead.prototype.getListFromCookie=function(){return $.cookie?$.cookie(this.settings.dataSources.cookie):null},Typeahead.prototype.getData=function(){var me=this,settings=me.settings,data=me.recentlyViewed,searchTerm=me.searchField.val(),ds=me.getDataSource(),dataSource=settings.dataSources[ds];if(searchTerm.length&&(searchTerm=searchTerm.trim()),searchTerm.length<3&&settings.dataSources.editorial&&(searchTerm="",data=cache[searchTerm]))return void me.showResults(data,data.title);if(handleError=function(r){var self=this;self.lastTerm=null},cache[searchTerm]&&dataSource)items=cache[searchTerm],me.showResults(items,items.title);else{if(!dataSource||searchTerm.length<3&&searchTerm===me.lastTerm)return me.clear(),!0;searchTerm=searchTerm.toLowerCase().substring(0,3).replace(" ","+"),url=new FD.Url(dataSource.url),"searchSuggest"==ds&&(querystring=new FD.Url.QueryString("?key="+searchTerm),url.querystring=querystring),me.lastTerm=searchTerm;var icon=me.searchBox.find(".icon-fdc-search");icon.removeClass("icon-fdc-search").addClass("icon-fdc-loading fa-spin"),$.ajax({url:url.toString(),type:"GET",dataType:dataSource.type,success:function(response,e){if("ERROR"==response.responseType)return void handleError.call(me,response);var items=response.suggestion,title=response.title||null;items&&items.length&&(items.datasource=ds,items.title=title,cache[searchTerm]=items,me.showResults(items,title)),icon.addClass("icon-fdc-search").removeClass("icon-fdc-loading fa-spin")},error:function(r,e){handleError.call(me,r)}})}},window.FD&&(FD.Search=Typeahead),$.fn.fdTypeAhead=function(options,overrides){var containers=this;return containers.each(function(){var container=$(this),instance=new Typeahead(container,options);overrides&&"object"==typeof overrides&&$.extend(instance,overrides),container.data("fd-typeahead",instance)}),containers},$.ui=$.ui||{},$.extend($.ui,{version:"1.11.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}})}(jQuery),function($){function ScrollTracker(element,options){this.settings=$.extend(!0,{},defaults,options||{}),this.element=$(element||window),this.scrollPosition=this.element.scrollTop(),this.init(),this.delayScrollTrack=null,this.timestamp=0,this.eventName="fd.scrolled",$(window).scroll()}var defaults={},direction={none:0,up:1,down:2,left:3,right:4};ScrollTracker.prototype.init=function(){var self=this;return self.settings.publish?void $(window).scroll(function(event){var args={},now=new Date,ts=now.getTime(),win=$(this),top=win.scrollTop(),left=win.scrollLeft();clearTimeout(self.delayScrollTrack),self.lastStamp=ts,args.position=top,args.viewport={height:win.height(),width:win.width(),top:args.position,bottom:top+win.height(),left:left,right:left+win.width()},args.direction=args.position>self.scrollPosition?direction.down:direction.up,args.change=args.position-self.scrollPosition,args.change<0&&(args.change=-1*args.change),self.settings.publish(self.eventName,args),self.scrollPosition=args.position}):void log("ScrollTracker: no pub/sub object configured.")},FD.direction=direction,$(function(){FD.scrollTracker=new ScrollTracker(window,{publish:FD.publish})})}(jQuery),window.FD||(window.FD={}),function($){FD.Video={Util:{msToMMSS:function(duration){var seconds=parseInt(duration/1e3%60),minutes=parseInt(duration/6e4%60);return minutes=10>minutes?"0"+minutes:minutes,seconds=10>seconds?"0"+seconds:seconds,minutes+":"+seconds}}}}(jQuery),FD.WebServices={domain:function(){return"localhost.dev1-food.com"==window.location.hostname?"http://www.dev1-food.com/":"share.dev1-food.com"==window.location.hostname?"http://www.dev1-food.com/":"share.qa1-food.com"==window.location.hostname?"http://www.qa1-food.com/":"share.food.com"==window.location.hostname?"http://www.food.com/":"/"}(),checkUrl:function(urlString){var url=new FD.Url(urlString);if("localhost"==url.host){var path=url.path.startsWith("/php")?url.path.substr(4):url.path,host="//localhost:7001";return path.contains(".php")?host="//localhost":path.startsWith("/RZWeb")||(path="/RZWeb"+path),url.setUrl("//localhost:7001"+path+url.querystring+url.hash).toString()}return urlString},fetch:function(url,method,data,dataType,callback){var ws=this;return FD.Session.isSignedIn()?void $.ajax({url:ws.checkUrl(url),type:method,data:data||null,dataType:dataType||"xml",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);callback.call(this,data)}else ws._logError("WebServices: "+url,request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},getCookbooks:function(callback){var ws=this,url=ws.domain+"services/rest/booklist.php";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"xml",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);callback.call(this,ws.cookbooksToObject(data))}else ws._logError("getCookbooks",request,textStatus),
callback.call(this,!1)}}):(ws.login(),!1)},getFolders:function(assetId,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/fdc/listFolders?assetId="+assetId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){log("----------"),log("response: "+request.responseText),log("----------"),ws.isValidStatus(request.status)?callback.call(this,ws.foldersToObject(request.responseText,assetId),request.responseText):(ws._logError("getCookbooks",request,textStatus),callback.call(this,!1))}}):(ws.login(),!1)},getFoldersMobile:function(assetId,inAllFolder,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/fdc/listFolders?assetId="+assetId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){log("----------"),log("response: "+request.responseText),log("----------"),ws.isValidStatus(request.status)?callback.call(this,ws.foldersToObjectMobile(request.responseText,assetId,inAllFolder),request.responseText):(ws._logError("getCookbooks",request,textStatus),callback.call(this,!1))}}):(ws.login(),!1)},isInAFolder:function(assetId,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/isSaved?json=true&id="+assetId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var jsonResponse=JSON.parse(request.responseText);callback.call(this,jsonResponse.mrb.alreadySaved)}else ws._logError("isInAFolder",request,textStatus),callback.call(this,!1)}}):!1},isInAFolderSync:function(assetId,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/isSaved?json=true&id="+assetId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",async:!1,dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var jsonResponse=JSON.parse(request.responseText);callback.call(this,jsonResponse.mrb.alreadySaved)}else ws._logError("isInAFolder",request,textStatus),callback.call(this,!1)}}):!1},isInShoppingList:function(assetId,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/fdc/inShoppingList?json=true&id="+assetId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){var jsonResponse,inShoppingList=!1;ws.isValidStatus(request.status)&&request.responseText?(jsonResponse=JSON.parse(request.responseText),inShoppingList=jsonResponse&&jsonResponse.data&&jsonResponse.data[assetId]&&jsonResponse.data[assetId].inShoppingList||!1):ws._logError("isInAFolder",request,textStatus),callback&&callback.call(this,inShoppingList)}}):!1},getFolder:function(folderId,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/userFolders?json=true&id="+folderId;return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},complete:function(request,textStatus){log("----------"),log("response: "+request.responseText),log("----------"),ws.isValidStatus(request.status)?callback.call(this,ws.foldersToObject(request.responseText)):(ws._logError("getCookbooks",request,textStatus),callback.call(this,!1))}}):(ws.login(),!1)},createCookbook:function(name,callback){var ws=this,url=ws.domain+"services/rest/books/create.php";return FD.Session.isSignedIn()?(debug_message("you pass"),void $.ajax({url:url,type:"POST",dataType:"xml",cache:!1,data:{name:name},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);callback.call(this,ws.foldersToObject(data))}else ws._logError("createCookbook",request,textStatus),callback.call(this,"Error creating cookbook")}})):(ws.login(),!1)},createFolder:function(name,id,callback){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/userRecipes";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",dataType:"json",cache:!1,xhrFields:{withCredentials:!0},data:{json:!0,action:"add",folderTitle:name,folderNote:"",id:id},complete:function(request,textStatus){log(request.responseText),log(request.status),ws.isValidStatus(request.status)?(log("------ After 200"),log(request.responseText),log("------"),callback.call(this,JSON.parse(request.responseText))):(ws._logError("createFolder",request,textStatus),callback.call(this,"Error creating folder"))}}):(ws.login(),!1)},addToCookbook:function(cookbookId,recipeId,callback){return this.addToList(cookbookId,recipeId,callback,"cookbook")},removeFromCookbook:function(cookbookId,recipeIds,callback){return this.removeFromList(cookbookId,recipeIds,callback,"cookbook")},getMenus:function(callback){var ws=this,url=ws.domain+"services/rest/menu/mylist.php";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"GET",cache:!1,complete:function(request,textStatus){if(debug_message("here"),ws.isValidStatus(request.status)){callback.call(this,ws.menusToObject(request.responseText))}else ws._logError("getMenus",request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},createMenu:function(name,callback){var ws=this,url=ws.domain+"services/rest/menu/create.php";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"POST",dataType:"xml",cache:!1,data:{name:name},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);debug_message(data.find("exception")),callback.call(this,ws.menuToObject(data))}else debug_message(request+":"+textStatus),ws._logError("createMenu",request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},addToMenu:function(menuId,recipeId,callback){var ws=this,url=ws.domain+"services/rest/menu/putitem.php";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"POST",dataType:"xml",cache:!1,data:{menuid:menuId,id:recipeId,type:"recipe"},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);callback.call(this,data)}else ws._logError("addToMenu",request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},cookbooksToObject:function(xml){var book,elem,cookbooks={};return xml.find("book").each(function(){book={},elem=$(this),book.id=elem.attr("lid"),book["public"]=elem.attr("public"),book.size=elem.attr("size"),book.name=elem.find("name").text(),book.desc=elem.find("desc").text(),cookbooks[book.id]=book}),cookbooks},foldersToObject:function(xml,recipeId){var fObject=JSON.parse(xml);log("---------"),log(fObject),log("---------");var folder,elem,folders={};folder={};var isInAFolder=!1;if("undefined"!=typeof fdc.Recipe&&"undefined"!=typeof fdc.Recipe.isInFolder&&(isInAFolder=fdc.Recipe.isInFolder),folder.id=0,folder.name="All",folder.inFolder=isInAFolder,folder["public"]=!1,folder.size=0,folder.desc="",folder.url=FD.Config.RecipeBoxApiUrl,folders[folder.id]=folder,"undefined"!=typeof fObject.folders){var data=fObject.folders;for(var key in data)folder={},elem=data[key],folder.id=elem._id,folder.name=elem.title,folder.inFolder=elem.inFolder,folder["public"]=!1,folder.size=0,folder.desc="",folder.url=elem.url,folder.inFolder&&(isInAFolder=!0),folder.inFolder===!0&&(folder.name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folder.name),folders[folder.id]=folder}else if("undefined"!=typeof fObject.mrb){var data=fObject.mrb.dataSet.folder;folder={},elem=data,folder.id=elem.id,folder.name=elem.title,folder.inFolder=!0,folder["public"]=!1,folder.size=0,folder.desc="",folder.url="",folder.inFolder&&(isInAFolder=!0),folder.inFolder===!0&&(folder.name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folder.name),folders[folder.id]=folder}return folders[0].inFolder=isInAFolder,isInAFolder&&(folders[0].name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folders[0].name),folders},foldersToObjectMobile:function(xml,recipeId,inAllFolder){var fObject=JSON.parse(xml);log("---------"),log(fObject),log("---------");var folder,elem,folders={};if(folder={},folder.id=0,folder.name="All",folder.inFolder=inAllFolder,folder["public"]=!1,folder.size=0,folder.desc="",folder.url=FD.Config.RecipeBoxApiUrl,folders[folder.id]=folder,"undefined"!=typeof fObject.folders){var data=fObject.folders;for(var key in data)folder={},elem=data[key],folder.id=elem._id,folder.name=elem.title,folder.inFolder=elem.inFolder,folder["public"]=!1,folder.size=0,folder.desc="",folder.url=elem.url,folder.inFolder&&(isInAFolder=!0),folder.inFolder===!0&&(folder.name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folder.name),folders[folder.id]=folder}else if("undefined"!=typeof fObject.mrb){var data=fObject.mrb.dataSet.folder;folder={},elem=data,folder.id=elem.id,folder.name=elem.title,folder.inFolder=!0,folder["public"]=!1,folder.size=0,folder.desc="",folder.url="",folder.inFolder&&(isInAFolder=!0),folder.inFolder===!0&&(folder.name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folder.name),folders[folder.id]=folder}return folders[0].inFolder=inAllFolder,inAllFolder&&(folders[0].name='<i style="color: green; font-size: 12pt;" class="icon-ok"></i> '+folders[0].name),folders},cookbookToObject:function(xml){var book=xml.find("book"),cookbook=null;return book.length>0&&(cookbook={},cookbook.id=book.attr("num"),cookbook["public"]="no",cookbook.size="0",cookbook.name=book.find("name").text(),cookbook.desc=""),cookbook},menusToObject:function(response){try{response=eval(response);var menus={},menu,elem;return debug_message("triggered menusToObject"),$.each(response,function(key,elem){menu={},menu.id=elem.menuid,menu.name=elem.name,menu["public"]=elem.ispublic,menus[menu.id]=menu}),menus}catch(e){return!1}},menuToObject:function(xml){var menu=xml.find("menu"),result=null;return menu.length>0&&(debug_message("triggered menuToObject"),result={},result.id=menu.attr("id"),result.name=menu.find("name").text(),result["public"]="no"),result},addToShoppingList:function(recipeId,callback){return this.addToList("shoplist",recipeId,callback)},addToList:function(listId,recipeId,callback,type){var ws=this,url=FD.Config.RecipeBoxApiUrl+"/api/shoppingLists";return FD.Session.isSignedIn()?(debug_message("logged in"),void $.ajax({url:url,type:"GET",dataType:"xml",cache:!1,data:{json:!0,action:"add",recipeId:recipeId},xhrFields:{withCredentials:!0},complete:function(request,textStatus){ws.isValidStatus(request.status)?callback.call(this,request.responseText):(ws._logError("addToList",request,textStatus),debug_message(request+":"+textStatus),callback.call(this,!1))}})):(debug_message("not logged in"),ws.login(),!1)},removeFromList:function(listId,recipeId,callback,type){var dt={lid:listId,rid:recipeId};"undefined"!=typeof type&&(dt=$.extend({isa:type},dt));var ws=this,url=ws.domain+"services/rest/listdel";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"POST",data:dt,cache:!1,complete:function(request,textStatus){if(debug_message("think you removed recipes?"),ws.isValidStatus(request.status))callback.call(this,$(request.responseXML));else{debug_message("error");callback.call(this,ws.menusToObject(request.responseText))}}}):(ws.login(),!1)},addChefToFavorites:function(chefId,callback){return this.updateFavorites("add","chef",chefId,callback)},deleteChefFromFavorites:function(chefId,callback){return this.updateFavorites("del","chef",chefId,callback)},addCategoryToFavorites:function(categoryId,callback){return this.updateFavorites("add","category",categoryId,callback)},deleteCategoryFromFavorites:function(categoryId,callback){return this.updateFavorites("del","category",categoryId,callback)},addCookbookToFavorites:function(cookbookId,callback){return this.updateFavorites("add","cookbook",cookbookId,callback)},deleteCookbookFromFavorites:function(cookbookId,callback){return this.updateFavorites("del","cookbook",cookbookId,callback)},addForumToFavorites:function(forumId,callback){return this.updateFavorites("add","forum",forumId,callback)},deleteForumFromFavorites:function(forumId,callback){return this.updateFavorites("del","forum",forumId,callback)},addMenuToFavorites:function(menuId,callback){return this.updateFavorites("add","menu",menuId,callback)},deleteMenuFromFavorites:function(menuId,callback){return this.updateFavorites("del","menu",menuId,callback)},updateFavorites:function(action,type,id,callback){var ws=this,url=ws.domain+"services/rest/member/favorites";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"POST",dataType:"xml",cache:!1,xhrFields:{withCredentials:!0},data:{op:action,type:type,id:id},complete:function(request,textStatus){if(debug_message(request.status),ws.isValidStatus(request.status)){debug_message("wheeee");var data=$(request.responseXML);debug_message("ok, you pass. do your thing."),callback.call(this,data)}else debug_message("no whee"),ws._logError("updateFavorites",request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},sendToMobilePhone:function(recipeId,callback){var ws=this,url=ws.domain+"services/rest/sendmail";return FD.Session.isSignedIn()?void $.ajax({url:url,type:"POST",dataType:"xml",cache:!1,data:{address:"mobile","data[rid]":recipeId,tpl:"mobilerecipelink",subject:"You Have Requested a recipe from food.com"},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML);callback.call(this,data)}else ws._logError("sendToMobilePhone",request,textStatus),callback.call(this,!1)}}):(ws.login(),!1)},getEnvironment:function(){return FD.Config.MetaData.environment},getLoginLink:function(redirect){var url=SNI.Community.UR.globalLoginURL,destination="?DEST_URL="+encodeURIComponent(redirect||document.location.href);return url+destination},login:function(redirect){if(!FD.Session.isSignedIn()){if(FD.Util.isGigyaEnabled())return FD.Session.register(),!1;if(window.AIMHook)return window.AIMHook("register"),!1;(void 0===redirect||""===redirect)&&(redirect=window.location.href),this.redirect(this.getLoginLink(redirect))}return!0},postAddToFav:function(obj,data){data&&obj.html("Added to favourite")},redirect:function(url){window.location.href=url},isValidStatus:function(status){return 200==status},getIngredientCount:function(searchTerms){var ws=this,url=ws.domain+"services/rest/ingredsearch.php";$.ajax({url:url,type:"GET",dataType:"xml",cache:!1,data:{q:searchTerms},complete:function(request,textStatus){if(ws.isValidStatus(request.status)){var data=$(request.responseXML),count="0";data.find("ingredient").each(function(){count=$(this).find("resultcount").text()}),$("#ingredcount").html("Ingredients<em>("+count+")</em>")}}})},ingerdCountFromXML:function(xml){var result="0";return xml.find("ingredient").each(function(){result=$(this).find("resultcount").text()}),result},_logError:function(method,request,textStatus,errorThrown){},getRecipeReviews:function(id,callback){var ws=this,url=ws.domain+"rz2.6/PHP/services/rest/recipes/reviews.php?rid="+id;$.ajax({url:url,type:"GET",dataType:"json",cache:!1,success:function(data,textStatus,jqXHR){callback.call(this,data.reviews)}})},getSlideShow:function(id,preview,callback){var ws=this,url=ws.domain+"rzfoodservices/web/slideshow/getSlideShow";$.ajax({url:url,type:"GET",dataType:"json",data:{slideShowId:id,slideShowPreview:!!preview},cache:!0,success:callback,error:function(){log(arguments)}})},getFoodHolidayDetails:function(day,callback){var ws=this,url=ws.domain+"rzfoodservices/web/food-holidays/getDay";$.ajax({url:url,type:"GET",dataType:"json",data:{day:day},cache:!0,success:callback,error:function(){log(arguments)}})}},"undefined"==typeof FD&&(FD={}),"undefined"!=typeof jQuery&&function($){function Header(options){var defaults={selector:{header:"#fdc-navbar",searchContainer:".fd-search",searchButton:"#fd-search-button",searchCancelButton:".fd-search-cancel",searchTopButton:".fd-back-to-top",searchInput:"input",navbar:"#fdc-navbar",menu:".fdc-menu",logo:"#fd-logo",login:".sso-login",register:".sso-sign-up",logout:".sso-logout",profile:".sso-profile",linkAccount:".sso-link"},navbarHeight:75,scrollEvent:"fd.scrolled",cssClass:{sticky:"stick",showSticky:"show"}};this.settings=$.extend(!0,{},defaults,options||{}),this.init()}$.extend(!0,FD,{Ads:{pageHasLeaderboard:!1}}),SniAds.Event.subscribe("slotRenderComplete",function(slot){var adType=FD.Page.getAdType(slot);slot.isEmpty||"dfp_leaderboard"!==adType||(FD.Ads.pageHasLeaderboard=!0)}),Header.prototype.isHeaderFixed=function(){var self=this,settings=self.settings,nav=$(settings.selector.header);return nav.hasClass(settings.cssClass.sticky)},Header.prototype.isMenuOpen=function(){return $(".navbar-collapse.in").length>0},Header.prototype.isNavFixed=function(){return $(".navbar").is("."+this.settings.cssClass.sticky)},Header.prototype.startScrollTracking=function(){var self=this,settings=self.settings,cssClass=settings.cssClass;FD.subscribe(self.settings.scrollEvent,function(data){var nav=$(self.settings.selector.header),adWrap=$(".ad-wrap"),adHeight=adWrap.outerHeight(!0),topThreshhold=nav.outerHeight(!0)+adHeight;self.isMenuOpen()||(data.position>topThreshhold?(nav.hasClass(cssClass.sticky)?nav.addClass(cssClass.sticky):nav.addClass(cssClass.sticky+" "+cssClass.showSticky),data.direction==FD.direction.up?nav.addClass(cssClass.showSticky):(nav.removeClass(cssClass.showSticky),self.search.clear())):data.position<=adHeight&&(nav.removeClass(cssClass.sticky).removeClass(cssClass.showSticky),self.search.clear()),self.setAdZIndex())})},Header.prototype.setAdZIndex=function(targetZIndex){var me=this,adWrap=$(".ad-wrap"),zIndex=adWrap.data("zindex");zIndex||(zIndex=parseInt(adWrap.css("z-index")),adWrap.data("zindex",zIndex)),me.isNavFixed()&&zIndex--,adWrap.css("z-index",zIndex)},Header.prototype.setMenuHeight=function(menu){var me=this,nav=$(".navbar"),navHeight=nav.height(),winHeight=$(window).height(),leaderboardAdHeight=0;FD.Ads.pageHasLeaderboard&&(leaderboardAdHeight=$("div[data-dfp-type='dfp_leaderboard']").first().height()),menu&&0!=menu.length||(menu=$(me.settings.selector.header).find(".navbar-collapse.in")),menu.length>0&&(menu.height()+navHeight+leaderboardAdHeight>winHeight&&menu.height(winHeight-navHeight-leaderboardAdHeight),FD.publish("FD.menu.setheight",[menu]))},Header.prototype.showMenu=function(e){var me=this,menu=(me.settings.selector,$(".navbar"),$(".navbar-collapse.in"));FD.viewports.viewport();me.setMenuHeight(menu),me.setAdZIndex(),me.affixBody(me.isMenuOpen())},Header.prototype.affixBody=function(isFixed){var self=this,body=$("body"),win=$(window),scrollPosition=($(self.settings.selector.header),win.scrollTop()),top=-scrollPosition,css={position:"fixed",top:top,left:0,overflow:"hidden",width:"100%"};isFixed?body.css(css):(top=-body.scrollTop(),css={position:"static",top:"auto",left:"auto",overflow:"visible",width:"unset"},body.css(css),win.scrollTop(top))},Header.prototype.setupMenus=function(){var me=this;$(".collapse").on("shown.bs.collapse hidden.bs.collapse",function(e){var collapses=$(this),eType=e.type,action="shown"==eType?"addClass":"removeClass",id=collapses.attr("id"),btn=$("[data-target=#"+id+"]");btn.length>1&&(btn=btn.eq(0).is(":visible")?btn.eq(0):btn.eq(1)),btn[action]("active"),"addClass"==action&&(btn.siblings('[data-toggle="collapse"]').removeClass("active"),collapses.siblings(".fdc-menu").addClass("collapse").removeClass("in")),me.showMenu(e)}),$(window).on("resize",function(){me.setMenuHeight()}),$(document).on("click",function(e){var menuId,buttonSelector,target=$(e.target),selector="[data-toggle][data-target]",menu=$(".navbar-collapse:visible"),isMenuOpen=menu.length>0,isMenuElement=target.parents(".navbar-collapse").length>0;target.is(selector)||0!=target.parents(selector).length||isMenuOpen&&!isMenuElement&&(menuId=menu.attr("id"),buttonSelector='[data-target="#'+menuId+'"]',$(buttonSelector).first().click())}),$(".exit-beta").on("click",function(){FD.Util.exitBeta()}),$(".close-pushdown-message").on("click",function(){FD.Util.closePushdown()}),$(".fd-email-signup-submit").on("click",function(){var $self=$(this),$pushdown=$self.closest(".pushdown-message"),$errorMessage=$pushdown.find(".invalid-email-message"),emailInput=$pushdown.find(".fd-email-input").val().trim();FD.Util.isValidEmail(emailInput)?($pushdown.find(".fd-email-input, .fd-email-signup-submit").fadeOut(),$errorMessage.hide(),me.subscribeToNewsletter(emailInput)):me.displayPushdownError("Please enter a valid email address.")}),FD.Session.onReady(function(){FD.Util.openPushdown()})},Header.prototype.subscribeToNewsletter=function(email){var self=this,$pushdown=$(".pushdown-message"),$pushdownMessage=$pushdown.find("p");$.ajax({url:"http://mynewsletters.scrippsnetworks.com/webservice.php",data:{method:"put",username:"api_user",password:"ECB00423CE66BECB0D",auth_token:"424D6B4BE6E8179A03CE6CB0BD75E8ABB21AFE275BCD56F62F3A03872F26887E",emailaddress:email,privacy:"privacy",source:"FC_FCDD_Header_2015",foodcom_holiday365:"Y",brand:"Food"},type:"POST",dataType:"xml",success:function(response){$pushdownMessage.addClass("fd-pushdown-thankyou"),$pushdownMessage.html("We knew we liked the looks of you &mdash; Happy eating!"),setTimeout(function(){FD.Util.closePushdown()},3500)},error:function(xhr,status,error){self.displayPushdownError("Oops! There was an error signing you up. Please try again shortly!"),log("Error: "+error),log("Status: "+status),console.dir(xhr)}})},Header.prototype.displayPushdownError=function(errorMessage){var $pushdown=$(".pushdown-message"),$errorMessage=$pushdown.find(".invalid-email-message");$errorMessage.html(errorMessage),$errorMessage.fadeIn("slow")},Header.prototype.toggleSearch=function(btn){var selector=this.settings.selector,search=$(selector.searchContainer),logo=search.siblings(selector.logo),showSearch=parseInt(search.css("top"))<0;btn.is(selector.searchCancelButton)&&FD.publish("FD.Header.CancelSearch"),showSearch?(search.css("top","auto"),logo.hide()):(search.css("top","-100%"),logo.show())},Header.prototype.toggleTopButton=function(){var selector=this.settings.selector,search=$(selector.searchContainer);search.find(selector.searchCancelButton),search.find(selector.searchTopButton)},Header.prototype.setupSearchEvents=function(){var self=this,settings=self.settings,selector=settings.selector,container=$(selector.searchContainer);FD.viewports.viewport();$("button.fd-sch-btn").click(function(){self.toggleSearch($(this))}),$(selector.searchCancelButton).click(function(){self.toggleSearch($(this))}),$(window).on("resize",function(){}),container.find(selector.searchInput).on("focusin",function(){var input=$(this);input.parents(".input-group").addClass("focus"),self.toggleTopButton()}).on("focusout",function(){var input=$(this);input.parents(".input-group").removeClass("focus")}),$(selector.searchContainer).find("form").on("submit",function(e){e.preventDefault(),log("search form submit")})},Header.prototype.setupSearchTypeAhead=function(){var self=this,el=$("#fdc-navbar .fd-search-group");self.search=new FD.Search(el),el.find(".icon-fdc-search").click(function(){FD.publish(self.search.selectEventName,self.search)}),FD.subscribe(self.search.selectEventName,function(ta){var settings=ta.settings,selectors=settings.cssSelectors,form=$(selectors.searchForm),field=form.find("input"),term=field.val()||"all",action=form.attr("data-action")||form.attr("action"),params=form.attr("data-params"),url=new FD.Url(("all"==term?action:action.replace("all",term.toURIComponent()))+"?"+params);term.trim().length&&(location.href=url.toString())})},Header.prototype.encodeLocation=function(){return encodeURIComponent(location.href)},Header.prototype.initRedirectLinks=function(){var me=this;$('a[href*="DEST_URL"]').each(function(){var link=$(this),href=new FD.Url(link.href);href.val("DEST_URL",me.encodeLocation()),link.attr("href",href.toString())})},Header.prototype.loggedIn=function(){var greeting,user=FD.Session.user,headerWrap=$(".fd-header-wrap");if(FD.Session.isActiveSession()){greeting="Hi, "+user.fdUserName,headerWrap.addClass("fd-logged-in").find(".fd-greet, #fdc-user-menu .navbar-lead a").text(greeting);var defaultAvatar=FD.Config.SocialUploader.cloudinaryUrl+"/fl_progressive,w_41,h_41,c_fill,q_92"+FD.Config.SocialUploader.cloudinaryFullBucket+"/img/placeholder/avatar.jpg";if(user.userAvatar){var image=headerWrap.find(".fd-avatar img");image.on("error",function(){image.attr("src",defaultAvatar)}).attr("src",user.userAvatar)}}},Header.prototype.init=function(){var self=this;$(function(){self.startScrollTracking(),self.setupMenus(),self.setupSearchEvents(),self.setupSearchTypeAhead()})},FD.header=new Header}(jQuery),function($){function Combobbox(options){var me=this,defaults={cssClass:{toggle:"active",selected:"selected",hover:"hover"},cssSelectors:{container:".fd-site-wrapper",combo:".combo",input:"select",toggle:".active",selected:".selected",hover:".hover"}};me.settings=$.extend(!0,{},defaults,options||{});var selectors=me.settings.cssSelectors,$combo=$(selectors.combo),$input=$combo.find(selectors.input);$combo.attr("tabindex","0"),$input.attr("tabindex","-1"),this.setEvents()}Combobbox.prototype.setEvents=function(){var me=this,classes=me.settings.cssClass,selectors=me.settings.cssSelectors,$container=$(selectors.container),combo=selectors.combo,input=selectors.combo+" "+selectors.input;FD.viewports.isSmallScreen()||FD.viewports.isMediumScreen()?(console.log("Small/Medium Mode for combobox"),$(input).on("change",function(){var $this=$(this),$combo=$this.closest(selectors.combo),$input=$this;$combo.find("ul li.selected").removeClass(classes.selected),$combo.find('ul li[data-value="'+$input.val()+'"]').addClass(classes.selected),console.log("Input value"+$input.val()),FD.publish("combobox.selected.changed",[$input.val(),$combo])})):(console.log("Large/XLarge Mode for combobox"),$container.on("mousedown",combo,function(e){console.log("mousedown"),$(this).toggleClass(classes.toggle),$(this).find("ul li").removeClass(classes.hover)}).on("focus",combo,function(e){console.log("focus"),$(this).addClass(classes.toggle)}).on("focusout",combo,function(){console.log("focusout"),$(this).removeClass(classes.toggle),$(this).find("ul li").removeClass(classes.hover)}).on("keydown",combo,function(e){console.log("keydown");var hoverIdx,key=e.which,$combo=$(this),$ul=$combo.find("ul"),$li=$ul.find("li"),length=$li.length,$hovered=$ul.find(selectors.hover);switch($combo.find("ul li").removeClass(classes.hover),$hovered.length?console.log("use hovered"):(console.log("use selected"),$hovered=$ul.find(selectors.selected)),hoverIdx=$hovered.index(),9!==key&&e.preventDefault(),key){case 40:$ul.is(":visible")?length-1>hoverIdx&&hoverIdx++:$combo.addClass(classes.toggle);break;case 38:$ul.is(":visible")?hoverIdx>0&&hoverIdx--:$combo.addClass(classes.toggle);break;case 13:$ul.is(":visible")&&($hovered.siblings("li").removeClass(classes.selected),$hovered.addClass(classes.selected),$combo.find(selectors.input).val($hovered.text()),log("combobox.selected.changed"),FD.publish("combobox.selected.changed",[$hovered.data("value"),$combo]));case 32:$combo.toggleClass(classes.toggle)}$($li.get(hoverIdx)).addClass(classes.hover)}).on("mouseover",combo+" ul li",function(){console.log("mouseover"),$(this).siblings("li").removeClass(classes.hover),$(this).addClass(classes.hover)}).on("mousedown",combo+" ul li",function(){console.log("mousedown");var $this=$(this),$combo=$this.closest(selectors.combo),$input=$combo.find(selectors.input),selection=$(this).text();$this.siblings().removeClass(classes.selected),$this.addClass(classes.selected),$input.val(selection),log("combobox.selected.changed"),FD.publish("combobox.selected.changed",[$this.data("value"),$combo])}))},"undefined"==typeof FD&&(FD={}),FD.tools||(FD.tools={}),FD.tools.Combos=Combobbox}(jQuery),function(){"undefined"==typeof FD.Session&&(FD.Session={});var gigyaScreenSet="FDC-LoginReg";FD.Session={complete:!1,cookies:{SMSESSION:document.cookie.match(new RegExp("SMSESSION=([^;]+)")),AIM:document.cookie.match(new RegExp("aimInfo=([^;]+)"))},isSignedIn:function(){return this.isActiveSession()},requireAccount:function(fn){var me=this;me.isActiveSession()?fn&&fn():me.register()},isActiveSession:function(){var me=this,smsession=me.cookies.SMSESSION;return(FD.Util.exists(smsession)||FD.Config.MetaData.gigyaMode)&&FD.Util.exists(me.user)&&FD.Util.exists(me.user.memberId)},redirectBookmark:function(){var url=new FD.Url;if(url.hash&&url.hash.contains("/")){var hash=(url.path,url.hash),page=hash.Trim("#.").split("?")[0],parts=url.path.split("/");parts=url.path.split("/"),parts.pop(),parts.push(page),url.path=parts.join("/"),window.location=url.toString()}},sso:function(){var looper=$.cookie("sso-aim-looper");return looper?!1:($.cookie("sso-aim-looper","1",{expires:1,path:"/"}),!0)},auth:{gigyaScreenSet:{login:{screenSet:gigyaScreenSet},register:{screenSet:gigyaScreenSet,startScreen:"gigya-register-screen"},link:{screenSet:gigyaScreenSet,startScreen:"gigya-link-account-screen"},thankyou:{screenSet:gigyaScreenSet,startScreen:"gigya-thank-you-screen"},forgotPassword:{screenSet:gigyaScreenSet,startScreen:"gigya-forgot-password-screen"},resetPassword:{screenSet:gigyaScreenSet,startScreen:"gigya-password-change-required-screen"}},action:function(screenSetName,redirectUrl){var auth=this,screenSet=$.extend({},auth.gigyaScreenSet[screenSetName],{onAfterScreenLoad:auth.onAfterScreenLoad});if(FD.Config.MetaData.gigyaMode)gigya.accounts.showScreenSet(screenSet);else switch(screenSetName){case"login":FD.WebServices.login(redirectUrl);break;case"register":}},onAfterScreenLoad:function(eventObj){SNI.Analytics.trackGigyaScreenSet(eventObj)},processResponse:function(response){var fdState=$.Deferred(),rbState=$.Deferred(),gigyaState=$.Deferred();"login"===response.eventName?(log("FD.Session.auth.processResponse::onLogin",response),$.when(gigyaState).done(function(gigyaState){$.when(fdState,rbState).done(function(fdData,rbData){console.log(fdData),fdData&&"success"===fdData.result&&"standard"===response.loginMode?FD.publish("fd.session.loginVerified"):fdData&&"success"===fdData.result?FD.publish("fd.session.reauthVerified"):FD.publish("fd.session.loginFailed")})}),$.ajax({type:"get",url:FD.Config.apiServerURL+"/login-verify",data:{uid:encodeURIComponent(response.UID),timestamp:response.signatureTimestamp,signature:response.UIDSignature,loginMode:response.loginMode},xhrFields:{withCredentials:!0}}).always(function(data,textStatus){fdState.resolve("success"===textStatus?data:void 0)}),$.ajax({type:"POST",url:FD.Config.RecipeBoxApiURL+"/users/ajax/gigya/login",data:{gigyaUserId:encodeURIComponent(response.UID),signatureTimestamp:response.signatureTimestamp,uidSignature:response.UIDSignature},xhrFields:{withCredentials:!0}}).always(function(){rbState.resolve()}),gigya.accounts.getAccountInfo({callback:function(){if("undefined"!=typeof arguments&&"undefined"!=typeof arguments[0]){var gigyaUser=arguments[0],gigyaUserData=gigyaUser.data;"undefined"==typeof gigyaUserData.user||"undefined"==typeof gigyaUserData.user.visited?SNI.Analytics.trackGigyaRegistration(!0):"undefined"==typeof gigyaUserData.user.visited.fdc&&"undefined"!=typeof gigyaUserData.user.visited.fn&&SNI.Analytics.trackGigyaRegistration(!1)}gigyaState.resolve()}})):(log("FD.Session.auth.processResponse::onLogout",response),$.when(fdState,rbState).done(function(fdData,rbData){"success"===fdData&&FD.publish("fd.session.logoutVerified")}),$.ajax({type:"get",url:FD.Config.apiServerURL+"/logout",xhrFields:{withCredentials:!0}}).always(function(data,textStatus){fdState.resolve(textStatus)}),$('<iframe id="rb-logout" width="0" height="0"></iframe>').appendTo("body"),$("#rb-logout").on("load",function(){rbState.resolve()}),$("#rb-logout").attr("src",FD.Config.RecipeBoxApiURL+"/users/ajax/gigya/logout"))},setupEvents:function(){var session=FD.Session;session.gigyaInitialized||(session.gigyaInitialized=!0,$(function(){var hdr=FD.header,selector=hdr.settings.selector;FD.Util.exists(gigya)&&gigya.socialize&&gigya.socialize.addEventHandlers&&gigya.socialize.addEventHandlers({
onLogin:session.auth.processResponse,onLogout:session.auth.processResponse}),$(document).on("click",selector.login,function(e){e.preventDefault(),FD.publish("fd.session.login",[this])}),$(document).on("click",selector.register,function(e){e.preventDefault(),FD.publish("fd.session.register",[this])}),$(document).on("click",selector.logout,function(e){e.preventDefault(),FD.publish("fd.session.logout",[this])}),$(document).on("click",selector.linkAccount,function(e){e.preventDefault(),session.linkAccount(),FD.publish("fd.session.linkaccount",[this])}),$(document).on("click",".sso-thankyou",function(e){e.preventDefault(),session.thankyou(),FD.publish("fd.session.thankyou",[this])}),$(document).on("click",".gigya-screen-dialog-close",function(e){e.preventDefault()}),$(document).on("click",".gigya-screen .gigya-composite-control-password .input-group-addon",function(){var btn=$(this),field=btn.siblings("input.gigya-input-password"),typ=field.attr("type");"password"==typ?(field.attr("type","text"),btn.text("hide")):(field.attr("type","password"),btn.text("show"))})}),FD.subscribe("fd.session.login",function(){log("## Event: Show Gigya Login..."),session.login()}),FD.subscribe("fd.session.register",function(){log("## Event: Show Gigya Register..."),session.register()}),FD.subscribe("fd.session.logout",function(){log("## Event: Gigya Logout..."),session.logout()}))},init:function(){var auth=this;auth.setupEvents(),!FD.Config.MetaData.gigyaMode}},login:function(redirectUrl){this.auth.action("login",redirectUrl||document.location.href)},register:function(redirectUrl){this.auth.action("register",redirectUrl||document.location.href)},linkAccount:function(){this.auth.action("link")},thankyou:function(user){this.auth.action("thankyou")},forgotPassword:function(){this.auth.action("forgotPassword")},resetPassword:function(){this.auth.action("resetPassword")},logout:function(){if(FD.Config.MetaData.gigyaMode)gigya.socialize.logout();else{var url=new FD.Url(SNI.Community.UR.globalLogoutBaseUrl);url.querystring.val("DEST_URL",FD.header.encodeLocation()),window.location.href=url.toString()}},init:function(config){FD.Config||(FD.Config={}),$.extend(FD.Config,config||{});var session=this,AIMcookie=FD.Session.cookies.AIM,sessionCookie=FD.Session.cookies.SMSESSION;session.redirectBookmark(),AIMcookie&&AIMcookie[1]&&sessionCookie&&sessionCookie[1]&&"0"!=sessionCookie[1]||FD.Config.MetaData.gigyaMode?FD.Session.getUserInfo():FD.Session.complete=!0,"undefined"!=typeof SNI_COMMUNITY_SOCIAL_UPLOAD&&SNI_COMMUNITY_SOCIAL_UPLOAD||(SNI_COMMUNITY_SOCIAL_UPLOAD={}),"undefined"!=typeof SNI_COMMUNITY_SERVICES&&SNI_COMMUNITY_SERVICES||(SNI_COMMUNITY_SERVICES={}),SNI_COMMUNITY_SOCIAL_UPLOAD.APP_KEY=FD.Config.SocialUploader.apiKey,SNI_COMMUNITY_SERVICES.SITE_NAME="fooddotcom",SNI_COMMUNITY_SERVICES.SITE_CODE="fdc",session.auth.init()},reconcileSession:function(data){FD.Config.MetaData.gigyaMode&&(!FD.Session.isSignedIn()||data&&data.UID&&""!==data.UID||$.ajax({url:FD.Config.apiServerURL+"/notify",cache:!1,dataType:"jsonp",xhrFields:{withCredentials:!0},success:function(data){console.log(data)}}))},getUserInfo:function(){var fdState=$.Deferred(),gigState=$.Deferred();$.when(fdState,gigState).done(function(fdData,gigData){FD.Session.reconcileSession(gigData)}),$.ajax({url:FD.Config.apiServerURL+"/rzfoodservices/web/member/getuserinfo?callback=?",cache:!1,contentType:"application/json",dataType:"jsonp",xhrFields:{withCredentials:!0},success:function(data){log("FD.Session.user (userinfo): ",data);FD.header;"undefined"!=typeof data.memberId&&(FD.Session.user=data,SNI.Community.UR.logged_in=FD.Util.exists(data),SNI.Community.UR.ViewingUserName=data.userName||"",SNI.Community.UR.ViewingUserDisplayName=data.fdUserName||"",SNI.Community.UR.ViewingUserPostalCode=data.postalCode||"",SNI.Community.UR.ViewingUserState=data.state||"",SNI.Community.UR.ViewingUserCountry=data.country||"",SNI.Community.UR.ViewingMemberId=data.memberId||"",SNI.Community.UR.ViewingUserId=data.userId||"",FD.header.loggedIn()),window.debug=!0,log("...publishing session complete"),FD.Session.complete=!0,FD.publish("FD.Session.complete",[]),fdState.resolve()},error:function(jqXHR,textStatus,errorThrown){log("ERROR userinfo: ",errorThrown),fdState.resolve()}}),FD.Config.MetaData.gigyaMode?gigya.accounts.getAccountInfo({callback:function(data){gigState.resolve(data)}}):gigState.resolve()},switchScreenSets:function(){function changePrefix(pfx,screenSet){var val=screenSet.split("-");return val[0]=pfx,val.join("-")}var session=this,screenSet=session.gigyaScreenSet,login=screenSet.login,register=screeSet.register,screenSetPrefix=["Default","FD"];prefix=screenSetPrefix[0],login.screenSet.startsWith(screenSetPrefix[0])&&(prefix=screenSetPrefix[1]),login.screenSet=changePrefix(prefix,login.screenSet),register.screenSet=changePrefix(prefix,register.screenSet)},onReady:function(callback){FD.Session.complete?callback.apply():FD.subscribe("FD.Session.complete",callback)}}}(),function($){function Viewport(name,min,max,tilesPerRow,label){this.name=name,this.min=min,this.max=max,this.tilesPerRow=tilesPerRow,this.label=label}function ViewportManager(options){var me=this;me.settings=$.extend(!0,defaults,options||{}),me.viewports=me.settings.breakpoints,this.viewports.sort(function(a,b){return a.min-b.min})}var defaults={adRowStart:2,adRowFrequency:8,selector:{contentStream:".fd-content",tile:".fd-tile",doubleTile:".fd-tile-double",ad:".fd-tile-ad",adTall:".ad-tall",adTower:".ad-tower",dfp:".dfp"},cssClass:{tile:"fd-tile",doubleTile:"fd-tile-double",ad:"fd-tile-ad",adTall:"ad-tall",adTower:"ad-tower"},template:{bigboxAd:'<div class="fd-tile fd-tile-double fd-tile-ad"><div class="fd-inner-tile"><div class="dfp" data-dfp-type="dfp_bigbox"></div></div></div>',rsiAd:'<div id="moduleAppend"></div><div id="resultAppend"></div>'},breakpoints:[new Viewport("xs",0,480,2,"small"),new Viewport("xs",481,767,2,"medium"),new Viewport("sm",768,1024,3,"medium"),new Viewport("md",1025,1299,4,"large"),new Viewport("lg",1300,1/0,5,"xlarge")]};defaults.breakpoints[0];ViewportManager.prototype.viewport=function(){var vp=null,screenWidth=$(window).width();return"number"==typeof screenWidth&&$.each(this.viewports,function(i,item){item.min<=screenWidth&&item.max>=screenWidth&&(vp=item)}),vp},ViewportManager.prototype.getSniAdBreakpoints=function(){var vm=this,breakpointCfg={};return $.each(vm.viewports,function(){var vp=this;switch(vp.name){case"xs":breakpointCfg.small||(breakpointCfg.small=[vp.min,0]);break;case"sm":breakpointCfg.medium=[vp.min,0];break;case"md":breakpointCfg.large=[vp.min,0];break;case"lg":breakpointCfg.xlarge=[vp.min,0]}}),breakpointCfg},ViewportManager.prototype.isSmallScreen=function(){var me=this,vp=me.viewport();return"xs"==vp.name},ViewportManager.prototype.isMediumScreen=function(){var me=this,vp=me.viewport();return"sm"==vp.name},ViewportManager.prototype.isLargeScreen=function(){var me=this,vp=me.viewport();return"md"==vp.name},ViewportManager.prototype.isXLargeScreen=function(){var me=this,vp=me.viewport();return"lg"==vp.name},ViewportManager.prototype.isInViewport=function(element,offsetTop,offsetLeft){var $el=element.jquery?element.length&&element.length>1?element.eq(0):element:$(element),pos=$el.offset(),$win=$(window),offsetTop=0!==$win.scrollTop()?offsetTop:0,top=$win.scrollTop()+(offsetTop||0),left=$win.scrollLeft()+(offsetLeft||0),bottom=top+$win.height(),right=left+$win.width();return pos.left>=left&&pos.left<=right&&pos.top>=top&&pos.top<=bottom},ViewportManager.prototype.loadDfpSlot=function(ad,tag){var slotName,me=this,settings=me.settings,id=ad.attr("id"),rsiAdLoaded=!1,currentPath=new FD.Url(window.location.href);if(tag){if(ad.parents(".fd-tile").length>0&&0==ad.siblings("#moduleAppend").length&&0==$("#moduleAppend").length&&currentPath.path.startsWith("/search")&&(ad.before(settings.template.rsiAd),SniAds.ready(function(){var rsiModuleSlotName=SniAds.appendSlot("moduleAppend","dfp_rsi_module",{},!0),rsiResultSlotName=SniAds.appendSlot("resultAppend","dfp_rsi_result",{},!0),bigBoxSlotName=SniAds.appendSlot(id,tag,{},!0);SniAds.refreshSlots([rsiModuleSlotName,rsiResultSlotName,bigBoxSlotName])}),rsiAdLoaded=!0),"dfp_grocery_list"===tag){var ingredientList=mdManager.getParameter("ingredients");ingredientList="undefined"!=typeof ingredientList?ingredientList.replace(/\s/g,"+"):"",slotName=SniAds.appendSlot(id,tag,{glist:ingredientList})}else if(!rsiAdLoaded){var dfpSyncAd=ad.data("dfp-sync");if(dfpSyncAd){var dfpSyncAdContainer=$(".dfp[data-dfp-type="+dfpSyncAd+"]").not('[data-dfp="loaded"]'),dfpSyncTag=dfpSyncAdContainer.data("dfpType"),dfpSyncId=dfpSyncAdContainer.attr("id");dfpSyncId||(dfpSyncId=dfpSyncTag+"_"+FD.Page.getUniqueId(),dfpSyncAdContainer.attr("id",dfpSyncId)),dfpSyncAdContainer.attr("data-dfp","loaded"),SniAds.ready(function(){var syncAdSlotName=SniAds.appendSlot(dfpSyncId,dfpSyncTag,{},!0),bigBoxSlotName=SniAds.appendSlot(id,tag,{},!0);SniAds.refreshSlots([syncAdSlotName,bigBoxSlotName])})}else slotName=SniAds.appendSlot(id,tag)}ad.data("slotName",slotName).attr("data-dfp","loaded"),FD.publish("fd.viewportmanager.dfploaded",[ad])}},ViewportManager.prototype.dfpLoader=function(options){function chkBreakpoint(vp,bp){if(vp.name==bp)return!0;var bps=["xs","sm","md","lg","xl"],vIdx=-1,bIdx=0;return $.each(bps,function(i,v){this==vp.name&&(vIdx=i),this==bp&&(bIdx=i)}),vIdx>=bIdx}var me=this,settings=$.extend(!0,{renderOutOfView:!1},me.settings,options||{}),dfp=$(settings.selector.dfp).not('[data-dfp="loaded"]');dfp.each(function(){var tag,ad=$(this),id=ad.attr("id"),breakpoint=ad.data("breakpoint")||null,vp=FD.viewports.viewport(),breakpointMatches=!breakpoint||vp.name==breakpoint||chkBreakpoint(vp,breakpoint);ad.is(":visible")&&breakpointMatches&&(tag=ad.data("dfpType"),id||(id=tag+"_"+FD.Page.getUniqueId(),ad.attr("id",id)),(me.isInViewport(ad,300)||settings.renderOutOfView)&&me.loadDfpSlot(ad,tag))})},ViewportManager.prototype.setAdPositions=function(){var iPos,nextIndex,target,vpm=this,settings=vpm.settings,selector=settings.selector,cssClass=settings.cssClass,contentStream=$(selector.contentStream),lastAd=$(selector.ad).last(),lastAdIsTall=lastAd.is(selector.adTall),lastAdIsTower=lastAd.is(selector.adTower),tiles=contentStream.find(selector.tile).not(".loading"),tileCount=tiles.length,vp=vpm.viewport(),firstAdIndex=settings.adRowStart*vp.tilesPerRow-2,adFrequency=settings.adRowFrequency*vp.tilesPerRow,nextAd=$(settings.template.bigboxAd),startIndex=tiles.index(lastAd);if(0>=startIndex&&(startIndex=0),"xs"!==vp.name&&(lastAd.is(selector.adTall)?adFrequency-=2:lastAd.is(selector.adTower)&&(adFrequency-=4)),nextIndex=iPos=startIndex,0!=tiles.length&&(tiles.slice(startIndex).each(function(){function indexMatched(){return 0==startIndex&&iPos==firstAdIndex||iPos-startIndex==adFrequency?!0:!1}var tile=$(this);return indexMatched()?!1:(iPos++,nextIndex++,void(tile.hasClass(cssClass.doubleTile)&&iPos++))}),0==startIndex&&nextIndex>=tileCount&&(nextIndex=tileCount-1,nextIndex>0&&nextIndex<=vp.tilesPerRow-1&&nextIndex>vp.tilesPerRow-3&&(nextIndex=vp.tilesPerRow-3)),!(nextIndex>tileCount&&nextIndex>firstAdIndex)&&(nextIndex>=startIndex&&(target=tiles.eq(nextIndex)),target&&target.length))){firstAdIndex>iPos||lastAdIsTall||lastAdIsTower||1==tiles.length?target.after(nextAd):target.before(nextAd);var ad=nextAd.find(selector.dfp).attr("id","dfp_bigbox_"+FD.Page.getUniqueId());vpm.loadDfpSlot(ad,"dfp_bigbox")}},FD.viewports=new ViewportManager,$(function(){var loadedEvent=FD.stream?"fd.results.loading_removed":"fd.results.loaded";FD.subscribe(loadedEvent,function(){FD.viewports.setAdPositions()}),FD.subscribe(FD.scrollTracker.eventName,function(data){data.direction==FD.direction.down&&FD.viewports.dfpLoader()}),FD.viewports.dfpLoader()}),SniAds.Event.subscribe("slotRenderComplete",function(){var args=arguments,adSlot=args&&args[0]||null,size=adSlot&&adSlot.size&&adSlot.size.length?{width:adSlot.size[0],height:adSlot.size[1]}:null,viewports=FD&&FD.viewports,css=viewports&&viewports.settings&&viewports.settings.cssClass,className=null,id=FD.Page.getAdType(adSlot);if(ad=$("#"+id),adHeight=ad.height(),tile=ad.parents(".fd-tile"),tileHeight=tile.height(),tile.length&&size&&size.height){switch(size.height){case 600:className=css&&css.adTall||"ad-tall";break;case 1050:className=css&&css.adTower||"ad-tower"}!className&&(size.height>tileHeight||adHeight>tileHeight)&&(className=css.adTall),"dfp_rsi_module_1"==id&&(className?(tile.removeClass(className),className=css.adTower):className=css.adTall),className&&(tile.addClass(className),adHeight>tileHeight&&tile.removeClass(className).addClass(css.adTower)),log("ad data",adSlot)}})}(jQuery),function(){function TrackingModule(selector,moduleFromUrl,moduleName){if(this.selector=selector,moduleFromUrl){var url=new FD.Url;this.name=url.path.Trim("/").split("/")[0]||"homepage"}else moduleName?this.name=moduleName:this.name=selector.contains(",")?selector.split(",")[0].trim():selector.Trim(".")}var module_selectors=[new TrackingModule(".navbar-header",!1,"header"),new TrackingModule(".navbar-collapse",!1,"menu"),new TrackingModule(".breadcrumbs"),new TrackingModule(".gigya-screen"),new TrackingModule("header, .fd-page-heading"),new TrackingModule(".fd-site-tools"),new TrackingModule(".pushdown-message"),new TrackingModule(".fd-tile","tile",!0),new TrackingModule(".slideshow-page",!0),new TrackingModule(".video-item",!0)];$(function(){var selector=".sso-login, .sso-sign-up, .sso-logout, [data-clicktrack]";$(document).on("click.sni.omniture",selector,function(){var $parent,moduleName,ico,element=this,$element=$(this),action=$element.text().trim()||$element.attr("title")||$element.attr("alt"),targetUrl=$element.attr("href")||"on page interaction",position=1;action||(ico=$element.find("i"),ico.length&&(action=ico.className)),$.each(module_selectors,function(){var trackingModule=this;return $parent=$element.parents(trackingModule.selector),$parent.length?(moduleName=trackingModule.name,!1):void 0}),"undefined"==typeof moduleName&&(moduleName=$element.attr("rel")||"General"),$parent&&$parent.length&&(position=$parent.find(element.tagName).index(element)),SNI.Analytics.moduleTrackLS(this,{ModuleName:moduleName,LinkTitle:action,LocUrl:document.location.href,LinkPosition:position,TargetUrl:targetUrl})})})}(),function($){function appendElement(elementData,tag,selectorAttr,target,callback){var element=document.querySelector(tag+"["+selectorAttr+'="'+elementData[selectorAttr]+'"]');if(!element){element=document.createElement(tag);for(var attr in elementData)element[attr]=elementData[attr];document.querySelector(target).appendChild(element),!!callback&&callback()}return element}function loadCSS(cssData,target,callback){return appendElement(cssData,"link","href",target,callback)}function loadScript(scrData,target,callback){return"string"==typeof scrData&&(scrData={src:scrData,type:"text/javascript"}),appendElement(scrData,"script","src",target,callback)}function DependencyModule(options){var self=this,defaults={events:{start:"fd.dependency.load.start",complete:"fd.dependency.load.complete",fail:"fd.dependency.load.fail",end:"fd.dependency.load.end"},waitTime:100};self.settings=$.extend(!0,defaults,options.settings||{}),self.name=options.name||"module_"+FD.Page.getUniqueId(),self.url=options.url,self.apis=options.apis;var ev=self.settings.events;for(var prop in ev)ev[prop]=ev[prop]+"_"+self.name;this.loaded=!1,this.subscribe(),this.load()}FD||(FD={}),FD.Config||(FD.Config={}),FD.Config.MetaData||(FD.Config.MetaData={}),FD.Config.MetaData.environment||(FD.Config.MetaData.environment="development"),FD.Config.imgServerURL||(FD.Config.imgServerURL="http://img.dev1-food.com");var env=FD.Config.MetaData.environment,isDev="development"==env,minify=isDev?"":".min";$.extend(FD.Config,{isDev:isDev,minify:minify}),FD.loadCSS=loadCSS,FD.loadScript=loadScript,FD.loadElement=appendElement,DependencyModule.prototype.subscribe=function(){var self=this,events=self.settings.events;FD.subscribe(events.complete,function(module){self.loaded=!0,self.settings.callback&&self.settings.callback(self),debug&&(log("--- Dependency Module ---"),log("SUCCESS: load complete."),log(self),log("--- /Dependency Module ---"))}),FD.subscribe(events.fail,function(module){var self=this;self.loaded=!1,debug&&(log("----- Dependency Module -----"),log("ERROR: dependency not loaded."),log(self),log("----- /Dependency Module ----s-"))})},DependencyModule.prototype.load=function(){var self=this;self.apisExist()||FD.loadScript(this.url,"body",function(){self.wait()})},DependencyModule.prototype.wait=function(){var self=this,tries=0;self.waiting=setInterval(function(){tries++,self.apisExist()&&(clearInterval(self.waiting),FD.publish(self.settings.events.complete,[self])),tries>300&&(clearInterval(self.waiting),FD.publish(self.settings.events.fail,[self]))},self.settings.waitTime)},DependencyModule.prototype.apisExist=function(){var self=this,apis=self.apis;apis.length;return apis.forEach(function(item,idx,arr){return self.loaded=!!self.namespaceExists(window,item.split(".")),self.loaded?void 0:!1}),self.loaded},DependencyModule.prototype.namespaceExists=function(context,namespace){var self=this,top=namespace.shift(),obj=context?context[top]:window[top];return namespace.length&&(obj=self.namespaceExists(obj,namespace)),obj},FD.DependencyModule=DependencyModule}(jQuery),"undefined"!=typeof jQuery&&function($){$.fn.outerHtml=function(){return this[0]&&this[0].outerHTML||""}}(jQuery),function($){function VisualTruncator(targets,options){var me=this;me.settings=$.extend({},defaults,options||{}),me.targets=targets,me.init()}var defaults={cssClass:{expand:"vtrunc-expand",more:"vtrunc-more",less:"vtrunc-less",ie:{expand:"vtrunc-expand-ie",more:"vtrunc-more-ie",less:"vtrunc-less-ie"}},selector:{more:".vtrunc-more",less:".vtrunc-less",init:"[data-visual-truncate]"},initAttribute:"data-visual-truncate",showLess:!1,events:{more:"expand"}};VisualTruncator.prototype.init=function(){var me=this,settings=me.settings;me.targets.not(settings.selector.init).each(function(){var t=this,$t=$(t),origHeight=$t.height();t.scrollHeight>origHeight&&($t.addClass(settings.cssClass.more).data("origHeight",origHeight),$t.attr(settings.initAttribute,1))}),me.setupEvents()},VisualTruncator.prototype.toggle=function(target){var me=this,settings=me.settings,cssClass=settings.cssClass,addClass=(settings.selector,cssClass.expand),remClass=cssClass.more;settings.showLess?(addClass=target.hasClass(cssClass.more)?cssClass.less:cssClass.more,remClass=addClass==cssClass.more?cssClass.less:cssClass.more,target.removeClass(remClass).addClass(addClass)):target.removeClass(remClass).addClass(addClass)},VisualTruncator.prototype.setupEvents=function(){var me=this,settings=me.settings;settings.cssClass;me.targets.filter(me.settings.selector.more).click(function(e){var $t=$(this);me.toggle($t),$t.trigger(me.settings.events.more,[e])})},VisualTruncator.prototype.config=function(key,val){var me=this;return"object"==typeof key&&key?($.extend(me.settings,key),me):"string"==typeof key?val?(me.settings[key]=val,me):delete me.settings[key]:!1},$.fn.visualTruncator=function(options){var targets=this;new VisualTruncator(targets,options)}}(jQuery),jQuery&&function($){$.fn.alias=function(){var actions=this;actions.each(function(){var alias=$(this),target=alias.data("target"),ev=alias.data("targetEvent"),context=alias.data("context");target&&ev&&alias.on(ev,function(e){e.preventDefault(),context&&$(this).parents(context).find(target).first().trigger(ev)||$(this).closest(target).trigger(ev)})})}}(jQuery),function($,document,undefined){function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses," "))}var pluses=/\+/g,config=$.cookie=function(key,value,options){if(value!==undefined){if(options=$.extend({},config.defaults,options),null===value&&(options.expires=-1),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}return value=config.json?JSON.stringify(value):String(value),document.cookie=[encodeURIComponent(key),"=",config.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}for(var decode=config.raw?raw:decoded,cookies=document.cookie.split("; "),i=0,l=cookies.length;l>i;i++){var parts=cookies[i].split("=");if(decode(parts.shift())===key){var cookie=decode(parts.join("="));return config.json?JSON.parse(cookie):cookie}}return null};config.defaults={},$.removeCookie=function(key,options){return null!==$.cookie(key)?($.cookie(key,null,options),!0):!1}}(jQuery,document),function($){function swipeDirection(x1,x2,y1,y2){return Math.abs(x1-x2)>=Math.abs(y1-y2)?x1-x2>0?"Left":"Right":y1-y2>0?"Up":"Down"}function longTap(){longTapTimeout=null,touch.last&&(touch.el.trigger("longTap"),touch={})}function cancelLongTap(){longTapTimeout&&clearTimeout(longTapTimeout),longTapTimeout=null}function cancelAll(){touchTimeout&&clearTimeout(touchTimeout),tapTimeout&&clearTimeout(tapTimeout),swipeTimeout&&clearTimeout(swipeTimeout),longTapTimeout&&clearTimeout(longTapTimeout),touchTimeout=tapTimeout=swipeTimeout=longTapTimeout=null,touch={}}function isPrimaryTouch(event){return("touch"==event.pointerType||event.pointerType==event.MSPOINTER_TYPE_TOUCH)&&event.isPrimary}function isPointerEventType(e,type){return e.type=="pointer"+type||e.type.toLowerCase()=="mspointer"+type}var touchTimeout,tapTimeout,swipeTimeout,longTapTimeout,gesture,touch={},longTapDelay=750;!function(){var now,delta,firstTouch,_isPointerType,deltaX=0,deltaY=0;"MSGesture"in window&&(gesture=new MSGesture,gesture.target=document.body),$(document).on("MSGestureEnd",function(e){var swipeDirectionFromVelocity=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;swipeDirectionFromVelocity&&(touch.el.trigger("swipe"),touch.el.trigger("swipe"+swipeDirectionFromVelocity))}).on("touchstart MSPointerDown pointerdown",function(e){(!(_isPointerType=isPointerEventType(e,"down"))||isPrimaryTouch(e))&&(firstTouch=_isPointerType?e:e.originalEvent.touches[0],e.originalEvent.touches&&1===e.originalEvent.touches.length&&touch.x2&&(touch.x2=void 0,touch.y2=void 0),now=Date.now(),delta=now-(touch.last||now),touch.el=$("tagName"in firstTouch.target?firstTouch.target:firstTouch.target.parentNode),touchTimeout&&clearTimeout(touchTimeout),touch.x1=firstTouch.pageX,touch.y1=firstTouch.pageY,delta>0&&250>=delta&&(touch.isDoubleTap=!0),touch.last=now,longTapTimeout=setTimeout(longTap,longTapDelay),gesture&&_isPointerType&&gesture.addPointer(e.pointerId))}).on("touchmove MSPointerMove pointermove",function(e){(!(_isPointerType=isPointerEventType(e,"move"))||isPrimaryTouch(e))&&(firstTouch=_isPointerType?e:e.originalEvent.touches[0],cancelLongTap(),touch.x2=firstTouch.pageX,touch.y2=firstTouch.pageY,deltaX+=Math.abs(touch.x1-touch.x2),deltaY+=Math.abs(touch.y1-touch.y2))}).on("touchend MSPointerUp pointerup",function(e){(!(_isPointerType=isPointerEventType(e,"up"))||isPrimaryTouch(e))&&(cancelLongTap(),touch.x2&&Math.abs(touch.x1-touch.x2)>30||touch.y2&&Math.abs(touch.y1-touch.y2)>30?swipeTimeout=setTimeout(function(){touch.el.trigger("swipe"),touch.el.trigger("swipe"+swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2)),touch={}},0):"last"in touch&&(30>deltaX&&30>deltaY?tapTimeout=setTimeout(function(){var event=$.Event("tap");event.cancelTouch=cancelAll,touch.el.trigger(event),touch.isDoubleTap?(touch.el&&touch.el.trigger("doubleTap"),touch={}):touchTimeout=setTimeout(function(){touchTimeout=null,touch.el&&touch.el.trigger("singleTap"),touch={}},250)},0):touch={}),deltaX=deltaY=0)}).on("touchcancel MSPointerCancel pointercancel",cancelAll),$(window).on("scroll",cancelAll)}(),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(eventName){$.fn[eventName]=function(callback){return this.on(eventName,callback)}})}(jQuery),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){$.extend($.fn,{validate:function(options){if(!this.length)return void(options&&options.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var validator=$.data(this[0],"validator");return validator?validator:(this.attr("novalidate","novalidate"),validator=new $.validator(options,this[0]),$.data(this[0],"validator",validator),validator.settings.onsubmit&&(this.validateDelegate(":submit","click",function(event){validator.settings.submitHandler&&(validator.submitButton=event.target),$(event.target).hasClass("cancel")&&(validator.cancelSubmit=!0),void 0!==$(event.target).attr("formnovalidate")&&(validator.cancelSubmit=!0)}),this.submit(function(event){function handle(){var hidden,result;return validator.settings.submitHandler?(validator.submitButton&&(hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val($(validator.submitButton).val()).appendTo(validator.currentForm)),result=validator.settings.submitHandler.call(validator,validator.currentForm,event),validator.submitButton&&hidden.remove(),void 0!==result?result:!1):!0}return validator.settings.debug&&event.preventDefault(),validator.cancelSubmit?(validator.cancelSubmit=!1,handle()):validator.form()?validator.pendingRequest?(validator.formSubmitted=!0,!1):handle():(validator.focusInvalid(),!1)})),validator)},valid:function(){var valid,validator;return $(this[0]).is("form")?valid=this.validate().form():(valid=!0,validator=$(this[0].form).validate(),this.each(function(){valid=validator.element(this)&&valid})),valid},removeAttrs:function(attributes){var result={},$element=this;return $.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value),$element.removeAttr(value)}),result},rules:function(command,argument){var settings,staticRules,existingRules,data,param,filtered,element=this[0];if(command)switch(settings=$.data(element.form,"validator").settings,staticRules=settings.rules,existingRules=$.validator.staticRules(element),command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument)),delete existingRules.messages,staticRules[element.name]=existingRules,argument.messages&&(settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages));break;case"remove":return argument?(filtered={},$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method],delete existingRules[method],"required"===method&&$(element).removeAttr("aria-required")}),filtered):(delete staticRules[element.name],existingRules)}return data=$.validator.normalizeRules($.extend({},$.validator.classRules(element),$.validator.attributeRules(element),$.validator.dataRules(element),$.validator.staticRules(element)),element),data.required&&(param=data.required,delete data.required,data=$.extend({required:param},data),$(element).attr("aria-required","true")),data.remote&&(param=data.remote,delete data.remote,data=$.extend(data,{remote:param})),data}}),$.extend($.expr[":"],{blank:function(a){return!$.trim(""+$(a).val())},filled:function(a){return!!$.trim(""+$(a).val())},unchecked:function(a){return!$(a).prop("checked")}}),$.validator=function(options,form){this.settings=$.extend(!0,{},$.validator.defaults,options),this.currentForm=form,this.init()},$.validator.format=function(source,params){return 1===arguments.length?function(){var args=$.makeArray(arguments);return args.unshift(source),$.validator.format.apply(this,args)}:(arguments.length>2&&params.constructor!==Array&&(params=$.makeArray(arguments).slice(1)),params.constructor!==Array&&(params=[params]),$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),function(){return n})}),source)},$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(element){this.lastActive=element,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(element)))},onfocusout:function(element){this.checkable(element)||!(element.name in this.submitted)&&this.optional(element)||this.element(element)},onkeyup:function(element,event){(9!==event.which||""!==this.elementValue(element))&&(element.name in this.submitted||element===this.lastElement)&&this.element(element)},onclick:function(element){element.name in this.submitted?this.element(element):element.parentNode.name in this.submitted&&this.element(element.parentNode)},highlight:function(element,errorClass,validClass){"radio"===element.type?this.findByName(element.name).addClass(errorClass).removeClass(validClass):$(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){"radio"===element.type?this.findByName(element.name).removeClass(errorClass).addClass(validClass):$(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,""),settings=validator.settings;settings[eventType]&&!this.is(settings.ignore)&&settings[eventType].call(validator,this[0],event)}this.labelContainer=$(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm),this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var rules,groups=this.groups={};$.each(this.settings.groups,function(key,value){"string"==typeof value&&(value=value.split(/\s/)),$.each(value,function(index,name){groups[name]=key})}),rules=this.settings.rules,$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)}),$(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",delegate).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",delegate),this.settings.invalidHandler&&$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),$(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),$.extend(this.submitted,this.errorMap),this.invalid=$.extend({},this.errorMap),this.valid()||$(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid();
},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){var cleanElement=this.clean(element),checkElement=this.validationTargetFor(cleanElement),result=!0;return this.lastElement=checkElement,void 0===checkElement?delete this.invalid[cleanElement.name]:(this.prepareElement(checkElement),this.currentElements=$(checkElement),result=this.check(checkElement)!==!1,result?delete this.invalid[checkElement.name]:this.invalid[checkElement.name]=!0),$(element).attr("aria-invalid",!result),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors),this.errorList=[];for(var name in errors)this.errorList.push({message:errors[name],element:this.findByName(name)[0]});this.successList=$.grep(this.successList,function(element){return!(element.name in errors)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){$.fn.resetForm&&$(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var i,count=0;for(i in obj)count++;return count},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(errors){errors.not(this.containers).text(""),this.addWrapper(errors).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&1===$.grep(this.errorList,function(n){return n.element.name===lastActive.name}).length&&lastActive},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled], [readonly]").not(this.settings.ignore).filter(function(){return!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in rulesCache||!validator.objectLength($(this).rules())?!1:(rulesCache[this.name]=!0,!0)})},clean:function(selector){return $(selector)[0]},errors:function(){var errorClass=this.settings.errorClass.split(" ").join(".");return $(this.settings.errorElement+"."+errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=$([]),this.toHide=$([]),this.currentElements=$([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset(),this.toHide=this.errorsFor(element)},elementValue:function(element){var val,$element=$(element),type=element.type;return"radio"===type||"checkbox"===type?$("input[name='"+element.name+"']:checked").val():"number"===type&&"undefined"!=typeof element.validity?element.validity.badInput?!1:$element.val():(val=$element.val(),"string"==typeof val?val.replace(/\r/g,""):val)},check:function(element){element=this.validationTargetFor(this.clean(element));var result,method,rule,rules=$(element).rules(),rulesCount=$.map(rules,function(n,i){return i}).length,dependencyMismatch=!1,val=this.elementValue(element);for(method in rules){rule={method:method,parameters:rules[method]};try{if(result=$.validator.methods[method].call(this,val,element,rule.parameters),"dependency-mismatch"===result&&1===rulesCount){dependencyMismatch=!0;continue}if(dependencyMismatch=!1,"pending"===result)return void(this.toHide=this.toHide.not(this.errorsFor(element)));if(!result)return this.formatAndAdd(element,rule),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method.",e),e}}if(!dependencyMismatch)return this.objectLength(rules)&&this.successList.push(element),!0},customDataMessage:function(element,method){return $(element).data("msg"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase())||$(element).data("msg")},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor===String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i];return void 0},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customDataMessage(element,method),!this.settings.ignoreTitle&&element.title||void 0,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;"function"==typeof message?message=message.call(this,rule.parameters,element):theregex.test(message)&&(message=$.validator.format(message.replace(theregex,"{$1}"),rule.parameters)),this.errorList.push({message:message,element:element,method:rule.method}),this.errorMap[element.name]=message,this.submitted[element.name]=message},addWrapper:function(toToggle){return this.settings.wrapper&&(toToggle=toToggle.add(toToggle.parent(this.settings.wrapper))),toToggle},defaultShowErrors:function(){var i,elements,error;for(i=0;this.errorList[i];i++)error=this.errorList[i],this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass),this.showLabel(error.element,error.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(element,message){var place,group,errorID,error=this.errorsFor(element),elementID=this.idOrName(element),describedBy=$(element).attr("aria-describedby");error.length?(error.removeClass(this.settings.validClass).addClass(this.settings.errorClass),error.html(message)):(error=$("<"+this.settings.errorElement+">").attr("id",elementID+"-error").addClass(this.settings.errorClass).html(message||""),place=error,this.settings.wrapper&&(place=error.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(place):this.settings.errorPlacement?this.settings.errorPlacement(place,$(element)):place.insertAfter(element),error.is("label")?error.attr("for",elementID):0===error.parents("label[for='"+elementID+"']").length&&(errorID=error.attr("id").replace(/(:|\.|\[|\])/g,"\\$1"),describedBy?describedBy.match(new RegExp("\\b"+errorID+"\\b"))||(describedBy+=" "+errorID):describedBy=errorID,$(element).attr("aria-describedby",describedBy),group=this.groups[element.name],group&&$.each(this.groups,function(name,testgroup){testgroup===group&&$("[name='"+name+"']",this.currentForm).attr("aria-describedby",error.attr("id"))}))),!message&&this.settings.success&&(error.text(""),"string"==typeof this.settings.success?error.addClass(this.settings.success):this.settings.success(error,element)),this.toShow=this.toShow.add(error)},errorsFor:function(element){var name=this.idOrName(element),describer=$(element).attr("aria-describedby"),selector="label[for='"+name+"'], label[for='"+name+"'] *";return describer&&(selector=selector+", #"+describer.replace(/\s+/g,", #")),this.errors().filter(selector)},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},validationTargetFor:function(element){return this.checkable(element)&&(element=this.findByName(element.name)),$(element).not(this.settings.ignore)[0]},checkable:function(element){return/radio|checkbox/i.test(element.type)},findByName:function(name){return $(this.currentForm).find("[name='"+name+"']")},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):!0},dependTypes:{"boolean":function(param){return param},string:function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){var val=this.elementValue(element);return!$.validator.methods.required.call(this,val,element)&&"dependency-mismatch"},startRequest:function(element){this.pending[element.name]||(this.pendingRequest++,this.pending[element.name]=!0)},stopRequest:function(element,valid){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[element.name],valid&&0===this.pendingRequest&&this.formSubmitted&&this.form()?($(this.currentForm).submit(),this.formSubmitted=!1):!valid&&0===this.pendingRequest&&this.formSubmitted&&($(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:!0,message:this.defaultMessage(element,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(className,rules){className.constructor===String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className)},classRules:function(element){var rules={},classes=$(element).attr("class");return classes&&$.each(classes.split(" "),function(){this in $.validator.classRuleSettings&&$.extend(rules,$.validator.classRuleSettings[this])}),rules},attributeRules:function(element){var method,value,rules={},$element=$(element),type=element.getAttribute("type");for(method in $.validator.methods)"required"===method?(value=element.getAttribute(method),""===value&&(value=!0),value=!!value):value=$element.attr(method),/min|max/.test(method)&&(null===type||/number|range|text/.test(type))&&(value=Number(value)),value||0===value?rules[method]=value:type===method&&"range"!==type&&(rules[method]=!0);return rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)&&delete rules.maxlength,rules},dataRules:function(element){var method,value,rules={},$element=$(element);for(method in $.validator.methods)value=$element.data("rule"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase()),void 0!==value&&(rules[method]=value);return rules},staticRules:function(element){var rules={},validator=$.data(element.form,"validator");return validator.settings.rules&&(rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{}),rules},normalizeRules:function(rules,element){return $.each(rules,function(prop,val){if(val===!1)return void delete rules[prop];if(val.param||val.depends){var keepRule=!0;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element)}keepRule?rules[prop]=void 0!==val.param?val.param:!0:delete rules[prop]}}),$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter}),$.each(["minlength","maxlength"],function(){rules[this]&&(rules[this]=Number(rules[this]))}),$.each(["rangelength","range"],function(){var parts;rules[this]&&($.isArray(rules[this])?rules[this]=[Number(rules[this][0]),Number(rules[this][1])]:"string"==typeof rules[this]&&(parts=rules[this].replace(/[\[\]]/g,"").split(/[\s,]+/),rules[this]=[Number(parts[0]),Number(parts[1])]))}),$.validator.autoCreateRanges&&(null!=rules.min&&null!=rules.max&&(rules.range=[rules.min,rules.max],delete rules.min,delete rules.max),null!=rules.minlength&&null!=rules.maxlength&&(rules.rangelength=[rules.minlength,rules.maxlength],delete rules.minlength,delete rules.maxlength)),rules},normalizeRule:function(data){if("string"==typeof data){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=!0}),data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method,$.validator.messages[name]=void 0!==message?message:$.validator.messages[name],method.length<3&&$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";if("select"===element.nodeName.toLowerCase()){var val=$(element).val();return val&&val.length>0}return this.checkable(element)?this.getLength(value,element)>0:$.trim(value).length>0},email:function(value,element){return this.optional(element)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(value)},url:function(value,element){return this.optional(element)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value).toString())},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 \-]+/.test(value))return!1;var n,cDigit,nCheck=0,nDigit=0,bEven=!1;if(value=value.replace(/\D/g,""),value.length<13||value.length>19)return!1;for(n=value.length-1;n>=0;n--)cDigit=value.charAt(n),nDigit=parseInt(cDigit,10),bEven&&(nDigit*=2)>9&&(nDigit-=9),nCheck+=nDigit,bEven=!bEven;return nCheck%10===0},minlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param},maxlength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||param>=length},rangelength:function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||param>=value},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},equalTo:function(value,element,param){var target=$(param);return this.settings.onfocusout&&target.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(element).valid()}),value===target.val()},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var validator,data,previous=this.previousValue(element);return this.settings.messages[element.name]||(this.settings.messages[element.name]={}),previous.originalMessage=this.settings.messages[element.name].remote,this.settings.messages[element.name].remote=previous.message,param="string"==typeof param&&{url:param}||param,previous.old===value?previous.valid:(previous.old=value,validator=this,this.startRequest(element),data={},data[element.name]=value,$.ajax($.extend(!0,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,context:validator.currentForm,success:function(response){var errors,message,submitted,valid=response===!0||"true"===response;validator.settings.messages[element.name].remote=previous.originalMessage,valid?(submitted=validator.formSubmitted,validator.prepareElement(element),validator.formSubmitted=submitted,validator.successList.push(element),delete validator.invalid[element.name],validator.showErrors()):(errors={},message=response||validator.defaultMessage(element,"remote"),errors[element.name]=previous.message=$.isFunction(message)?message(value):message,validator.invalid[element.name]=!0,validator.showErrors(errors)),previous.valid=valid,validator.stopRequest(element,valid)}},param)),"pending")}}}),$.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."};var ajax,pendingRequests={};$.ajaxPrefilter?$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;"abort"===settings.mode&&(pendingRequests[port]&&pendingRequests[port].abort(),pendingRequests[port]=xhr)}):(ajax=$.ajax,$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;return"abort"===mode?(pendingRequests[port]&&pendingRequests[port].abort(),pendingRequests[port]=ajax.apply(this,arguments),pendingRequests[port]):ajax.apply(this,arguments)}),$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);return target.is(delegate)?handler.apply(target,arguments):void 0})}})}),function(root,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory(require,exports,module):root.Tether=factory()}(this,function(require,exports,module){return function(){var Evented,addClass,defer,deferred,extend,flush,getBounds,getOffsetParent,getOrigin,getScrollBarSize,getScrollParent,hasClass,node,removeClass,uniqueId,updateClasses,zeroPosCache,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;null==this.Tether&&(this.Tether={modules:[]}),getScrollParent=function(el){var parent,position,scrollParent,style,_ref;if(position=getComputedStyle(el).position,"fixed"===position)return el;for(scrollParent=void 0,parent=el;parent=parent.parentNode;){try{style=getComputedStyle(parent)}catch(_error){}if(null==style)return parent;if(/(auto|scroll)/.test(style.overflow+style["overflow-y"]+style["overflow-x"])&&("absolute"!==position||"relative"===(_ref=style.position)||"absolute"===_ref||"fixed"===_ref))return parent}return document.body},uniqueId=function(){var id;return id=0,function(){return id++}}(),zeroPosCache={},getOrigin=function(doc){var id,k,node,v,_ref;if(node=doc._tetherZeroElement,null==node&&(node=doc.createElement("div"),node.setAttribute("data-tether-id",uniqueId()),extend(node.style,{top:0,left:0,position:"absolute"}),doc.body.appendChild(node),doc._tetherZeroElement=node),id=node.getAttribute("data-tether-id"),null==zeroPosCache[id]){zeroPosCache[id]={},_ref=node.getBoundingClientRect();for(k in _ref)v=_ref[k],zeroPosCache[id][k]=v;defer(function(){return zeroPosCache[id]=void 0})}return zeroPosCache[id]},node=null,getBounds=function(el){var box,doc,docEl,k,origin,v,_ref;el===document?(doc=document,el=document.documentElement):doc=el.ownerDocument,docEl=doc.documentElement,box={},_ref=el.getBoundingClientRect();for(k in _ref)v=_ref[k],box[k]=v;return origin=getOrigin(doc),box.top-=origin.top,box.left-=origin.left,null==box.width&&(box.width=document.body.scrollWidth-box.left-box.right),null==box.height&&(box.height=document.body.scrollHeight-box.top-box.bottom),box.top=box.top-docEl.clientTop,box.left=box.left-docEl.clientLeft,box.right=doc.body.clientWidth-box.width-box.left,box.bottom=doc.body.clientHeight-box.height-box.top,box},getOffsetParent=function(el){return el.offsetParent||document.documentElement},getScrollBarSize=function(){var inner,outer,width,widthContained,widthScroll;return inner=document.createElement("div"),inner.style.width="100%",inner.style.height="200px",outer=document.createElement("div"),extend(outer.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),outer.appendChild(inner),document.body.appendChild(outer),widthContained=inner.offsetWidth,outer.style.overflow="scroll",widthScroll=inner.offsetWidth,widthContained===widthScroll&&(widthScroll=outer.clientWidth),document.body.removeChild(outer),width=widthContained-widthScroll,{width:width,height:width}},extend=function(out){var args,key,obj,val,_i,_len,_ref;for(null==out&&(out={}),args=[],Array.prototype.push.apply(args,arguments),_ref=args.slice(1),_i=0,_len=_ref.length;_len>_i;_i++)if(obj=_ref[_i])for(key in obj)__hasProp.call(obj,key)&&(val=obj[key],out[key]=val);return out},removeClass=function(el,name){var cls,_i,_len,_ref,_results;if(null!=el.classList){for(_ref=name.split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)cls=_ref[_i],cls.trim()&&_results.push(el.classList.remove(cls));return _results}return el.className=el.className.replace(new RegExp("(^| )"+name.split(" ").join("|")+"( |$)","gi")," ")},addClass=function(el,name){var cls,_i,_len,_ref,_results;if(null!=el.classList){for(_ref=name.split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)cls=_ref[_i],cls.trim()&&_results.push(el.classList.add(cls));return _results}return removeClass(el,name),el.className+=" "+name},hasClass=function(el,name){return null!=el.classList?el.classList.contains(name):new RegExp("(^| )"+name+"( |$)","gi").test(el.className)},updateClasses=function(el,add,all){var cls,_i,_j,_len,_len1,_results;for(_i=0,_len=all.length;_len>_i;_i++)cls=all[_i],__indexOf.call(add,cls)<0&&hasClass(el,cls)&&removeClass(el,cls);for(_results=[],_j=0,_len1=add.length;_len1>_j;_j++)cls=add[_j],hasClass(el,cls)?_results.push(void 0):_results.push(addClass(el,cls));return _results},deferred=[],defer=function(fn){return deferred.push(fn)},flush=function(){var fn,_results;for(_results=[];fn=deferred.pop();)_results.push(fn());return _results},Evented=function(){function Evented(){}return Evented.prototype.on=function(event,handler,ctx,once){var _base;return null==once&&(once=!1),null==this.bindings&&(this.bindings={}),null==(_base=this.bindings)[event]&&(_base[event]=[]),this.bindings[event].push({handler:handler,ctx:ctx,once:once})},Evented.prototype.once=function(event,handler,ctx){return this.on(event,handler,ctx,!0)},Evented.prototype.off=function(event,handler){var i,_ref,_results;if(null!=(null!=(_ref=this.bindings)?_ref[event]:void 0)){if(null==handler)return delete this.bindings[event];for(i=0,_results=[];i<this.bindings[event].length;)this.bindings[event][i].handler===handler?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented.prototype.trigger=function(){var args,ctx,event,handler,i,once,_ref,_ref1,_results;if(event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],null!=(_ref=this.bindings)?_ref[event]:void 0){for(i=0,_results=[];i<this.bindings[event].length;)_ref1=this.bindings[event][i],handler=_ref1.handler,ctx=_ref1.ctx,once=_ref1.once,handler.apply(null!=ctx?ctx:this,args),once?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented}(),this.Tether.Utils={getScrollParent:getScrollParent,getBounds:getBounds,getOffsetParent:getOffsetParent,extend:extend,addClass:addClass,removeClass:removeClass,hasClass:hasClass,updateClasses:updateClasses,defer:defer,flush:flush,uniqueId:uniqueId,Evented:Evented,getScrollBarSize:getScrollBarSize}}.call(this),function(){var MIRROR_LR,MIRROR_TB,OFFSET_MAP,Tether,addClass,addOffset,attachmentToOffset,autoToFixedAttachment,defer,extend,flush,getBounds,getOffsetParent,getOuterSize,getScrollBarSize,getScrollParent,getSize,now,offsetToPx,parseAttachment,parseOffset,position,removeClass,tethers,transformKey,updateClasses,within,_Tether,_ref,__slice=[].slice,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");Tether=this.Tether,_ref=Tether.Utils,getScrollParent=_ref.getScrollParent,getSize=_ref.getSize,getOuterSize=_ref.getOuterSize,getBounds=_ref.getBounds,getOffsetParent=_ref.getOffsetParent,extend=_ref.extend,addClass=_ref.addClass,removeClass=_ref.removeClass,updateClasses=_ref.updateClasses,defer=_ref.defer,flush=_ref.flush,getScrollBarSize=_ref.getScrollBarSize,within=function(a,b,diff){return null==diff&&(diff=1),a+diff>=b&&b>=a-diff},transformKey=function(){var el,key,_i,_len,_ref1;for(el=document.createElement("div"),_ref1=["transform","webkitTransform","OTransform","MozTransform","msTransform"],_i=0,_len=_ref1.length;_len>_i;_i++)if(key=_ref1[_i],void 0!==el.style[key])return key}(),tethers=[],position=function(){var tether,_i,_len;for(_i=0,_len=tethers.length;_len>_i;_i++)tether=tethers[_i],tether.position(!1);return flush()},now=function(){var _ref1;return null!=(_ref1="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?_ref1:+new Date},function(){var event,lastCall,lastDuration,pendingTimeout,tick,_i,_len,_ref1,_results;for(lastCall=null,lastDuration=null,pendingTimeout=null,tick=function(){if(null!=lastDuration&&lastDuration>16)return lastDuration=Math.min(lastDuration-16,250),void(pendingTimeout=setTimeout(tick,250));if(!(null!=lastCall&&now()-lastCall<10))return null!=pendingTimeout&&(clearTimeout(pendingTimeout),pendingTimeout=null),lastCall=now(),position(),lastDuration=now()-lastCall},_ref1=["resize","scroll","touchmove"],_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)event=_ref1[_i],_results.push(window.addEventListener(event,tick));return _results}(),MIRROR_LR={center:"center",left:"right",right:"left"},MIRROR_TB={middle:"middle",top:"bottom",bottom:"top"},OFFSET_MAP={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},autoToFixedAttachment=function(attachment,relativeToAttachment){var left,top;return left=attachment.left,top=attachment.top,"auto"===left&&(left=MIRROR_LR[relativeToAttachment.left]),"auto"===top&&(top=MIRROR_TB[relativeToAttachment.top]),{left:left,top:top}},attachmentToOffset=function(attachment){var _ref1,_ref2;return{left:null!=(_ref1=OFFSET_MAP[attachment.left])?_ref1:attachment.left,top:null!=(_ref2=OFFSET_MAP[attachment.top])?_ref2:attachment.top}},addOffset=function(){var left,offsets,out,top,_i,_len,_ref1;for(offsets=1<=arguments.length?__slice.call(arguments,0):[],out={top:0,left:0},_i=0,_len=offsets.length;_len>_i;_i++)_ref1=offsets[_i],top=_ref1.top,left=_ref1.left,"string"==typeof top&&(top=parseFloat(top,10)),"string"==typeof left&&(left=parseFloat(left,10)),out.top+=top,out.left+=left;return out},offsetToPx=function(offset,size){return"string"==typeof offset.left&&-1!==offset.left.indexOf("%")&&(offset.left=parseFloat(offset.left,10)/100*size.width),"string"==typeof offset.top&&-1!==offset.top.indexOf("%")&&(offset.top=parseFloat(offset.top,10)/100*size.height),offset},parseAttachment=parseOffset=function(value){var left,top,_ref1;return _ref1=value.split(" "),top=_ref1[0],left=_ref1[1],{top:top,left:left}},_Tether=function(){function _Tether(options){this.position=__bind(this.position,this);var module,_i,_len,_ref1,_ref2;for(tethers.push(this),this.history=[],this.setOptions(options,!1),_ref1=Tether.modules,_i=0,_len=_ref1.length;_len>_i;_i++)module=_ref1[_i],null!=(_ref2=module.initialize)&&_ref2.call(this);this.position()}return _Tether.modules=[],_Tether.prototype.getClass=function(key){var _ref1,_ref2;return(null!=(_ref1=this.options.classes)?_ref1[key]:void 0)?this.options.classes[key]:(null!=(_ref2=this.options.classes)?_ref2[key]:void 0)!==!1?this.options.classPrefix?""+this.options.classPrefix+"-"+key:key:""},_Tether.prototype.setOptions=function(options,position){var defaults,key,_i,_len,_ref1,_ref2;for(this.options=options,null==position&&(position=!0),defaults={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=extend(defaults,this.options),_ref1=this.options,this.element=_ref1.element,this.target=_ref1.target,this.targetModifier=_ref1.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),_ref2=["element","target"],_i=0,_len=_ref2.length;_len>_i;_i++){if(key=_ref2[_i],null==this[key])throw new Error("Tether Error: Both element and target must be defined");null!=this[key].jquery?this[key]=this[key][0]:"string"==typeof this[key]&&(this[key]=document.querySelector(this[key]))}if(addClass(this.element,this.getClass("element")),addClass(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");return this.targetAttachment=parseAttachment(this.options.targetAttachment),this.attachment=parseAttachment(this.options.attachment),this.offset=parseOffset(this.options.offset),this.targetOffset=parseOffset(this.options.targetOffset),null!=this.scrollParent&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParent=this.target:this.scrollParent=getScrollParent(this.target),this.options.enabled!==!1?this.enable(position):void 0},_Tether.prototype.getTargetBounds=function(){var bounds,fitAdj,hasBottomScroll,height,out,scrollBottom,scrollPercentage,style,target;if(null==this.targetModifier)return getBounds(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:(bounds=getBounds(this.target),out={height:bounds.height,width:bounds.width,top:bounds.top,left:bounds.left},out.height=Math.min(out.height,bounds.height-(pageYOffset-bounds.top)),out.height=Math.min(out.height,bounds.height-(bounds.top+bounds.height-(pageYOffset+innerHeight))),out.height=Math.min(innerHeight,out.height),out.height-=2,out.width=Math.min(out.width,bounds.width-(pageXOffset-bounds.left)),out.width=Math.min(out.width,bounds.width-(bounds.left+bounds.width-(pageXOffset+innerWidth))),out.width=Math.min(innerWidth,out.width),out.width-=2,out.top<pageYOffset&&(out.top=pageYOffset),out.left<pageXOffset&&(out.left=pageXOffset),out);case"scroll-handle":return target=this.target,target===document.body?(target=document.documentElement,bounds={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):bounds=getBounds(target),style=getComputedStyle(target),hasBottomScroll=target.scrollWidth>target.clientWidth||"scroll"===[style.overflow,style.overflowX]||this.target!==document.body,
scrollBottom=0,hasBottomScroll&&(scrollBottom=15),height=bounds.height-parseFloat(style.borderTopWidth)-parseFloat(style.borderBottomWidth)-scrollBottom,out={width:15,height:.975*height*(height/target.scrollHeight),left:bounds.left+bounds.width-parseFloat(style.borderLeftWidth)-15},fitAdj=0,408>height&&this.target===document.body&&(fitAdj=-11e-5*Math.pow(height,2)-.00727*height+22.58),this.target!==document.body&&(out.height=Math.max(out.height,24)),scrollPercentage=this.target.scrollTop/(target.scrollHeight-height),out.top=scrollPercentage*(height-out.height-fitAdj)+bounds.top+parseFloat(style.borderTopWidth),this.target===document.body&&(out.height=Math.max(out.height,24)),out}},_Tether.prototype.clearCache=function(){return this._cache={}},_Tether.prototype.cache=function(k,getter){return null==this._cache&&(this._cache={}),null==this._cache[k]&&(this._cache[k]=getter.call(this)),this._cache[k]},_Tether.prototype.enable=function(position){return null==position&&(position=!0),addClass(this.target,this.getClass("enabled")),addClass(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),position?this.position():void 0},_Tether.prototype.disable=function(){return removeClass(this.target,this.getClass("enabled")),removeClass(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent?this.scrollParent.removeEventListener("scroll",this.position):void 0},_Tether.prototype.destroy=function(){var i,tether,_i,_len,_results;for(this.disable(),_results=[],i=_i=0,_len=tethers.length;_len>_i;i=++_i){if(tether=tethers[i],tether===this){tethers.splice(i,1);break}_results.push(void 0)}return _results},_Tether.prototype.updateAttachClasses=function(elementAttach,targetAttach){var add,all,side,sides,_i,_j,_len,_len1,_ref1,_this=this;for(null==elementAttach&&(elementAttach=this.attachment),null==targetAttach&&(targetAttach=this.targetAttachment),sides=["left","top","bottom","right","middle","center"],(null!=(_ref1=this._addAttachClasses)?_ref1.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),add=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],elementAttach.top&&add.push(""+this.getClass("element-attached")+"-"+elementAttach.top),elementAttach.left&&add.push(""+this.getClass("element-attached")+"-"+elementAttach.left),targetAttach.top&&add.push(""+this.getClass("target-attached")+"-"+targetAttach.top),targetAttach.left&&add.push(""+this.getClass("target-attached")+"-"+targetAttach.left),all=[],_i=0,_len=sides.length;_len>_i;_i++)side=sides[_i],all.push(""+this.getClass("element-attached")+"-"+side);for(_j=0,_len1=sides.length;_len1>_j;_j++)side=sides[_j],all.push(""+this.getClass("target-attached")+"-"+side);return defer(function(){return null!=_this._addAttachClasses?(updateClasses(_this.element,_this._addAttachClasses,all),updateClasses(_this.target,_this._addAttachClasses,all),_this._addAttachClasses=void 0):void 0})},_Tether.prototype.position=function(flushChanges){var elementPos,elementStyle,height,left,manualOffset,manualTargetOffset,module,next,offset,offsetBorder,offsetParent,offsetParentSize,offsetParentStyle,offsetPosition,ret,scrollLeft,scrollTop,scrollbarSize,side,targetAttachment,targetOffset,targetPos,targetSize,top,width,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(null==flushChanges&&(flushChanges=!0),this.enabled){for(this.clearCache(),targetAttachment=autoToFixedAttachment(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,targetAttachment),elementPos=this.cache("element-bounds",function(){return getBounds(_this.element)}),width=elementPos.width,height=elementPos.height,0===width&&0===height&&null!=this.lastSize?(_ref1=this.lastSize,width=_ref1.width,height=_ref1.height):this.lastSize={width:width,height:height},targetSize=targetPos=this.cache("target-bounds",function(){return _this.getTargetBounds()}),offset=offsetToPx(attachmentToOffset(this.attachment),{width:width,height:height}),targetOffset=offsetToPx(attachmentToOffset(targetAttachment),targetSize),manualOffset=offsetToPx(this.offset,{width:width,height:height}),manualTargetOffset=offsetToPx(this.targetOffset,targetSize),offset=addOffset(offset,manualOffset),targetOffset=addOffset(targetOffset,manualTargetOffset),left=targetPos.left+targetOffset.left-offset.left,top=targetPos.top+targetOffset.top-offset.top,_ref2=Tether.modules,_i=0,_len=_ref2.length;_len>_i;_i++)if(module=_ref2[_i],ret=module.position.call(this,{left:left,top:top,targetAttachment:targetAttachment,targetPos:targetPos,attachment:this.attachment,elementPos:elementPos,offset:offset,targetOffset:targetOffset,manualOffset:manualOffset,manualTargetOffset:manualTargetOffset,scrollbarSize:scrollbarSize}),null!=ret&&"object"==typeof ret){if(ret===!1)return!1;top=ret.top,left=ret.left}if(next={page:{top:top,left:left},viewport:{top:top-pageYOffset,bottom:pageYOffset-top-height+innerHeight,left:left-pageXOffset,right:pageXOffset-left-width+innerWidth}},document.body.scrollWidth>window.innerWidth&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.bottom-=scrollbarSize.height),document.body.scrollHeight>window.innerHeight&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.right-=scrollbarSize.width),(""!==(_ref3=document.body.style.position)&&"static"!==_ref3||""!==(_ref4=document.body.parentElement.style.position)&&"static"!==_ref4)&&(next.page.bottom=document.body.scrollHeight-top-height,next.page.right=document.body.scrollWidth-left-width),(null!=(_ref5=this.options.optimizations)?_ref5.moveElement:void 0)!==!1&&null==this.targetModifier){for(offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),offsetPosition=this.cache("target-offsetparent-bounds",function(){return getBounds(offsetParent)}),offsetParentStyle=getComputedStyle(offsetParent),elementStyle=getComputedStyle(this.element),offsetParentSize=offsetPosition,offsetBorder={},_ref6=["Top","Left","Bottom","Right"],_j=0,_len1=_ref6.length;_len1>_j;_j++)side=_ref6[_j],offsetBorder[side.toLowerCase()]=parseFloat(offsetParentStyle["border"+side+"Width"]);offsetPosition.right=document.body.scrollWidth-offsetPosition.left-offsetParentSize.width+offsetBorder.right,offsetPosition.bottom=document.body.scrollHeight-offsetPosition.top-offsetParentSize.height+offsetBorder.bottom,next.page.top>=offsetPosition.top+offsetBorder.top&&next.page.bottom>=offsetPosition.bottom&&next.page.left>=offsetPosition.left+offsetBorder.left&&next.page.right>=offsetPosition.right&&(scrollTop=offsetParent.scrollTop,scrollLeft=offsetParent.scrollLeft,next.offset={top:next.page.top-offsetPosition.top+scrollTop-offsetBorder.top,left:next.page.left-offsetPosition.left+scrollLeft-offsetBorder.left})}return this.move(next),this.history.unshift(next),this.history.length>3&&this.history.pop(),flushChanges&&flush(),!0}},_Tether.prototype.move=function(position){var css,elVal,found,key,moved,offsetParent,point,same,transcribe,type,val,write,writeCSS,_i,_len,_ref1,_ref2,_this=this;if(null!=this.element.parentNode){same={};for(type in position){same[type]={};for(key in position[type]){for(found=!1,_ref1=this.history,_i=0,_len=_ref1.length;_len>_i;_i++)if(point=_ref1[_i],!within(null!=(_ref2=point[type])?_ref2[key]:void 0,position[type][key])){found=!0;break}found||(same[type][key]=!0)}}css={top:"",left:"",right:"",bottom:""},transcribe=function(same,pos){var xPos,yPos,_ref3;return(null!=(_ref3=_this.options.optimizations)?_ref3.gpu:void 0)===!1?(same.top?css.top=""+pos.top+"px":css.bottom=""+pos.bottom+"px",same.left?css.left=""+pos.left+"px":css.right=""+pos.right+"px"):(same.top?(css.top=0,yPos=pos.top):(css.bottom=0,yPos=-pos.bottom),same.left?(css.left=0,xPos=pos.left):(css.right=0,xPos=-pos.right),css[transformKey]="translateX("+Math.round(xPos)+"px) translateY("+Math.round(yPos)+"px)","msTransform"!==transformKey?css[transformKey]+=" translateZ(0)":void 0)},moved=!1,(same.page.top||same.page.bottom)&&(same.page.left||same.page.right)?(css.position="absolute",transcribe(same.page,position.page)):(same.viewport.top||same.viewport.bottom)&&(same.viewport.left||same.viewport.right)?(css.position="fixed",transcribe(same.viewport,position.viewport)):null!=same.offset&&same.offset.top&&same.offset.left?(css.position="absolute",offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),getOffsetParent(this.element)!==offsetParent&&defer(function(){return _this.element.parentNode.removeChild(_this.element),offsetParent.appendChild(_this.element)}),transcribe(same.offset,position.offset),moved=!0):(css.position="absolute",transcribe({top:!0,left:!0},position.page)),moved||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),writeCSS={},write=!1;for(key in css)val=css[key],elVal=this.element.style[key],""===elVal||""===val||"top"!==key&&"left"!==key&&"bottom"!==key&&"right"!==key||(elVal=parseFloat(elVal),val=parseFloat(val)),elVal!==val&&(write=!0,writeCSS[key]=css[key]);return write?defer(function(){return extend(_this.element.style,writeCSS)}):void 0}},_Tether}(),Tether.position=position,this.Tether=extend(_Tether,Tether)}.call(this),function(){var BOUNDS_FORMAT,MIRROR_ATTACH,defer,extend,getBoundingRect,getBounds,getOuterSize,getSize,updateClasses,_ref,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};_ref=this.Tether.Utils,getOuterSize=_ref.getOuterSize,getBounds=_ref.getBounds,getSize=_ref.getSize,extend=_ref.extend,updateClasses=_ref.updateClasses,defer=_ref.defer,MIRROR_ATTACH={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle"},BOUNDS_FORMAT=["left","top","right","bottom"],getBoundingRect=function(tether,to){var i,pos,side,size,style,_i,_len;if("scrollParent"===to?to=tether.scrollParent:"window"===to&&(to=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),to===document&&(to=to.documentElement),null!=to.nodeType)for(pos=size=getBounds(to),style=getComputedStyle(to),to=[pos.left,pos.top,size.width+pos.left,size.height+pos.top],i=_i=0,_len=BOUNDS_FORMAT.length;_len>_i;i=++_i)side=BOUNDS_FORMAT[i],side=side[0].toUpperCase()+side.substr(1),"Top"===side||"Left"===side?to[i]+=parseFloat(style["border"+side+"Width"]):to[i]-=parseFloat(style["border"+side+"Width"]);return to},this.Tether.modules.push({position:function(_arg){var addClasses,allClasses,attachment,bounds,changeAttachX,changeAttachY,cls,constraint,eAttachment,height,left,oob,oobClass,p,pin,pinned,pinnedClass,removeClass,side,tAttachment,targetAttachment,targetHeight,targetSize,targetWidth,to,top,width,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_len5,_m,_n,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(top=_arg.top,left=_arg.left,targetAttachment=_arg.targetAttachment,!this.options.constraints)return!0;for(removeClass=function(prefix){var side,_i,_len,_results;for(_this.removeClass(prefix),_results=[],_i=0,_len=BOUNDS_FORMAT.length;_len>_i;_i++)side=BOUNDS_FORMAT[_i],_results.push(_this.removeClass(""+prefix+"-"+side));return _results},_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)}),height=_ref1.height,width=_ref1.width,0===width&&0===height&&null!=this.lastSize&&(_ref2=this.lastSize,width=_ref2.width,height=_ref2.height),targetSize=this.cache("target-bounds",function(){return _this.getTargetBounds()}),targetHeight=targetSize.height,targetWidth=targetSize.width,tAttachment={},eAttachment={},allClasses=[this.getClass("pinned"),this.getClass("out-of-bounds")],_ref3=this.options.constraints,_i=0,_len=_ref3.length;_len>_i;_i++)constraint=_ref3[_i],constraint.outOfBoundsClass&&allClasses.push(constraint.outOfBoundsClass),constraint.pinnedClass&&allClasses.push(constraint.pinnedClass);for(_j=0,_len1=allClasses.length;_len1>_j;_j++)for(cls=allClasses[_j],_ref4=["left","top","right","bottom"],_k=0,_len2=_ref4.length;_len2>_k;_k++)side=_ref4[_k],allClasses.push(""+cls+"-"+side);for(addClasses=[],tAttachment=extend({},targetAttachment),eAttachment=extend({},this.attachment),_ref5=this.options.constraints,_l=0,_len3=_ref5.length;_len3>_l;_l++){if(constraint=_ref5[_l],to=constraint.to,attachment=constraint.attachment,pin=constraint.pin,null==attachment&&(attachment=""),__indexOf.call(attachment," ")>=0?(_ref6=attachment.split(" "),changeAttachY=_ref6[0],changeAttachX=_ref6[1]):changeAttachX=changeAttachY=attachment,bounds=getBoundingRect(this,to),("target"===changeAttachY||"both"===changeAttachY)&&(top<bounds[1]&&"top"===tAttachment.top&&(top+=targetHeight,tAttachment.top="bottom"),top+height>bounds[3]&&"bottom"===tAttachment.top&&(top-=targetHeight,tAttachment.top="top")),"together"===changeAttachY&&(top<bounds[1]&&"top"===tAttachment.top&&("bottom"===eAttachment.top?(top+=targetHeight,tAttachment.top="bottom",top+=height,eAttachment.top="top"):"top"===eAttachment.top&&(top+=targetHeight,tAttachment.top="bottom",top-=height,eAttachment.top="bottom")),top+height>bounds[3]&&"bottom"===tAttachment.top&&("top"===eAttachment.top?(top-=targetHeight,tAttachment.top="top",top-=height,eAttachment.top="bottom"):"bottom"===eAttachment.top&&(top-=targetHeight,tAttachment.top="top",top+=height,eAttachment.top="top")),"middle"===tAttachment.top&&(top+height>bounds[3]&&"top"===eAttachment.top?(top-=height,eAttachment.top="bottom"):top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"))),("target"===changeAttachX||"both"===changeAttachX)&&(left<bounds[0]&&"left"===tAttachment.left&&(left+=targetWidth,tAttachment.left="right"),left+width>bounds[2]&&"right"===tAttachment.left&&(left-=targetWidth,tAttachment.left="left")),"together"===changeAttachX&&(left<bounds[0]&&"left"===tAttachment.left?"right"===eAttachment.left?(left+=targetWidth,tAttachment.left="right",left+=width,eAttachment.left="left"):"left"===eAttachment.left&&(left+=targetWidth,tAttachment.left="right",left-=width,eAttachment.left="right"):left+width>bounds[2]&&"right"===tAttachment.left?"left"===eAttachment.left?(left-=targetWidth,tAttachment.left="left",left-=width,eAttachment.left="right"):"right"===eAttachment.left&&(left-=targetWidth,tAttachment.left="left",left+=width,eAttachment.left="left"):"center"===tAttachment.left&&(left+width>bounds[2]&&"left"===eAttachment.left?(left-=width,eAttachment.left="right"):left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"))),("element"===changeAttachY||"both"===changeAttachY)&&(top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"),top+height>bounds[3]&&"top"===eAttachment.top&&(top-=height,eAttachment.top="bottom")),("element"===changeAttachX||"both"===changeAttachX)&&(left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"),left+width>bounds[2]&&"left"===eAttachment.left&&(left-=width,eAttachment.left="right")),"string"==typeof pin?pin=function(){var _len4,_m,_ref7,_results;for(_ref7=pin.split(","),_results=[],_m=0,_len4=_ref7.length;_len4>_m;_m++)p=_ref7[_m],_results.push(p.trim());return _results}():pin===!0&&(pin=["top","left","right","bottom"]),pin||(pin=[]),pinned=[],oob=[],top<bounds[1]&&(__indexOf.call(pin,"top")>=0?(top=bounds[1],pinned.push("top")):oob.push("top")),top+height>bounds[3]&&(__indexOf.call(pin,"bottom")>=0?(top=bounds[3]-height,pinned.push("bottom")):oob.push("bottom")),left<bounds[0]&&(__indexOf.call(pin,"left")>=0?(left=bounds[0],pinned.push("left")):oob.push("left")),left+width>bounds[2]&&(__indexOf.call(pin,"right")>=0?(left=bounds[2]-width,pinned.push("right")):oob.push("right")),pinned.length)for(pinnedClass=null!=(_ref7=this.options.pinnedClass)?_ref7:this.getClass("pinned"),addClasses.push(pinnedClass),_m=0,_len4=pinned.length;_len4>_m;_m++)side=pinned[_m],addClasses.push(""+pinnedClass+"-"+side);if(oob.length)for(oobClass=null!=(_ref8=this.options.outOfBoundsClass)?_ref8:this.getClass("out-of-bounds"),addClasses.push(oobClass),_n=0,_len5=oob.length;_len5>_n;_n++)side=oob[_n],addClasses.push(""+oobClass+"-"+side);(__indexOf.call(pinned,"left")>=0||__indexOf.call(pinned,"right")>=0)&&(eAttachment.left=tAttachment.left=!1),(__indexOf.call(pinned,"top")>=0||__indexOf.call(pinned,"bottom")>=0)&&(eAttachment.top=tAttachment.top=!1),(tAttachment.top!==targetAttachment.top||tAttachment.left!==targetAttachment.left||eAttachment.top!==this.attachment.top||eAttachment.left!==this.attachment.left)&&this.updateAttachClasses(eAttachment,tAttachment)}return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),{top:top,left:left}}})}.call(this),function(){var defer,getBounds,updateClasses,_ref;_ref=this.Tether.Utils,getBounds=_ref.getBounds,updateClasses=_ref.updateClasses,defer=_ref.defer,this.Tether.modules.push({position:function(_arg){var abutted,addClasses,allClasses,bottom,height,left,right,side,sides,targetPos,top,width,_i,_j,_k,_l,_len,_len1,_len2,_len3,_ref1,_ref2,_ref3,_ref4,_ref5,_this=this;if(top=_arg.top,left=_arg.left,_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)}),height=_ref1.height,width=_ref1.width,targetPos=this.getTargetBounds(),bottom=top+height,right=left+width,abutted=[],top<=targetPos.bottom&&bottom>=targetPos.top)for(_ref2=["left","right"],_i=0,_len=_ref2.length;_len>_i;_i++)side=_ref2[_i],((_ref3=targetPos[side])===left||_ref3===right)&&abutted.push(side);if(left<=targetPos.right&&right>=targetPos.left)for(_ref4=["top","bottom"],_j=0,_len1=_ref4.length;_len1>_j;_j++)side=_ref4[_j],((_ref5=targetPos[side])===top||_ref5===bottom)&&abutted.push(side);for(allClasses=[],addClasses=[],sides=["left","top","right","bottom"],allClasses.push(this.getClass("abutted")),_k=0,_len2=sides.length;_len2>_k;_k++)side=sides[_k],allClasses.push(""+this.getClass("abutted")+"-"+side);for(abutted.length&&addClasses.push(this.getClass("abutted")),_l=0,_len3=abutted.length;_len3>_l;_l++)side=abutted[_l],addClasses.push(""+this.getClass("abutted")+"-"+side);return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(_arg){var left,result,shift,shiftLeft,shiftTop,top,_ref;return top=_arg.top,left=_arg.left,this.options.shift?(result=function(val){return"function"==typeof val?val.call(this,{top:top,left:left}):val},shift=result(this.options.shift),"string"==typeof shift?(shift=shift.split(" "),shift[1]||(shift[1]=shift[0]),shiftTop=shift[0],shiftLeft=shift[1],shiftTop=parseFloat(shiftTop,10),shiftLeft=parseFloat(shiftLeft,10)):(_ref=[shift.top,shift.left],shiftTop=_ref[0],shiftLeft=_ref[1]),top+=shiftTop,left+=shiftLeft,{top:top,left:left}):void 0}})}.call(this),this.Tether}),function(){var ATTACHMENT,Evented,Shepherd,Step,Tour,addClass,createFromHTML,extend,getBounds,hasClass,matchesSelector,parseShorthand,removeClass,uniqueId,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};_ref=Tether.Utils,extend=_ref.extend,removeClass=_ref.removeClass,addClass=_ref.addClass,hasClass=_ref.hasClass,Evented=_ref.Evented,getBounds=_ref.getBounds,uniqueId=_ref.uniqueId,Shepherd=new Evented,ATTACHMENT={top:"bottom center",left:"middle right",right:"middle left",bottom:"top center"},createFromHTML=function(html){var el;return el=document.createElement("div"),el.innerHTML=html,el.children[0]},matchesSelector=function(el,sel){var matches,_ref1,_ref2,_ref3,_ref4;return matches=null!=(_ref1=null!=(_ref2=null!=(_ref3=null!=(_ref4=el.matches)?_ref4:el.matchesSelector)?_ref3:el.webkitMatchesSelector)?_ref2:el.mozMatchesSelector)?_ref1:el.oMatchesSelector,matches.call(el,sel)},parseShorthand=function(obj,props){var i,out,prop,vals,_i,_len;if(null==obj)return obj;if("object"==typeof obj)return obj;for(vals=obj.split(" "),vals.length>props.length&&(vals[0]=vals.slice(0,+(vals.length-props.length)+1||9e9).join(" "),vals.splice(1,vals.length-props.length)),out={},i=_i=0,_len=props.length;_len>_i;i=++_i)prop=props[i],out[prop]=vals[i];return out},Step=function(_super){function Step(tour,options){this.tour=tour,this.destroy=__bind(this.destroy,this),this.scrollTo=__bind(this.scrollTo,this),this.complete=__bind(this.complete,this),this.cancel=__bind(this.cancel,this),this.isOpen=__bind(this.isOpen,this),this.hide=__bind(this.hide,this),this.show=__bind(this.show,this),this.setOptions(options)}return __extends(Step,_super),Step.prototype.setOptions=function(options){var event,handler,_base,_ref1;if(this.options=null!=options?options:{},this.destroy(),this.id=this.options.id||this.id||"step-"+uniqueId(),this.options.when){_ref1=this.options.when;for(event in _ref1)handler=_ref1[event],this.on(event,handler,this)}return null!=(_base=this.options).buttons?(_base=this.options).buttons:_base.buttons=[{text:"Next",action:this.tour.next}]},Step.prototype.getTour=function(){return this.tour},Step.prototype.bindAdvance=function(){var event,handler,selector,_ref1,_this=this;return _ref1=parseShorthand(this.options.advanceOn,["selector","event"]),event=_ref1.event,selector=_ref1.selector,handler=function(e){if(_this.isOpen())if(null!=selector){if(matchesSelector(e.target,selector))return _this.tour.next()}else if(_this.el&&e.target===_this.el)return _this.tour.next()},document.body.addEventListener(event,handler),this.on("destroy",function(){return document.body.removeEventListener(event,handler)})},Step.prototype.getAttachTo=function(){var opts;if(opts=parseShorthand(this.options.attachTo,["element","on"]),null==opts&&(opts={}),"string"==typeof opts.element&&(opts.element=document.querySelector(opts.element),null==opts.element))throw new Error("Shepherd step's attachTo was not found in the page");return opts},Step.prototype.setupTether=function(){var attachment,opts,tetherOpts;if("undefined"==typeof Tether||null===Tether)throw new Error("Using the attachment feature of Shepherd requires the Tether library");return opts=this.getAttachTo(),attachment=ATTACHMENT[opts.on||"right"],null==opts.element&&(opts.element="viewport",attachment="middle center"),tetherOpts={classPrefix:"shepherd",element:this.el,constraints:[{to:"window",pin:!0,attachment:"together"}],target:opts.element,offset:opts.offset||"0 0",attachment:attachment},this.tether=new Tether(extend(tetherOpts,this.options.tetherOptions))},Step.prototype.show=function(){var _this=this;return null==this.el&&this.render(),addClass(this.el,"shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupTether(),this.options.scrollTo&&setTimeout(function(){return _this.scrollTo()}),this.trigger("show")},Step.prototype.hide=function(){var _ref1;return removeClass(this.el,"shepherd-open"),document.body.removeAttribute("data-shepherd-step"),null!=(_ref1=this.tether)&&_ref1.destroy(),this.tether=null,this.trigger("hide")},Step.prototype.isOpen=function(){return hasClass(this.el,"shepherd-open")},Step.prototype.cancel=function(){return this.tour.cancel(),this.trigger("cancel")},Step.prototype.complete=function(){return this.tour.complete(),this.trigger("complete")},Step.prototype.scrollTo=function(){var element;return element=this.getAttachTo().element,null!=element?element.scrollIntoView():void 0},Step.prototype.destroy=function(){var _ref1;return null!=this.el&&(document.body.removeChild(this.el),delete this.el),null!=(_ref1=this.tether)&&_ref1.destroy(),this.tether=null,this.trigger("destroy")},Step.prototype.render=function(){var button,buttons,cfg,content,footer,header,link,paragraph,paragraphs,text,_i,_j,_len,_len1,_ref1,_ref2,_ref3;if(null!=this.el&&this.destroy(),this.el=createFromHTML("<div class='shepherd-step "+(null!=(_ref1=this.options.classes)?_ref1:"")+"' data-id='"+this.id+"'></div>"),content=document.createElement("div"),content.className="shepherd-content",this.el.appendChild(content),header=document.createElement("header"),content.appendChild(header),null!=this.options.title&&(header.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink&&(link=createFromHTML("<a href class='shepherd-cancel-link'>✕</a>"),header.appendChild(link),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(link)),null!=this.options.text){for(text=createFromHTML("<div class='shepherd-text'></div>"),paragraphs=this.options.text,"string"==typeof paragraphs&&(paragraphs=[paragraphs]),_i=0,_len=paragraphs.length;_len>_i;_i++)paragraph=paragraphs[_i],text.innerHTML+="<p>"+paragraph+"</p>";content.appendChild(text)}if(footer=document.createElement("footer"),this.options.buttons){for(buttons=createFromHTML("<ul class='shepherd-buttons'></ul>"),_ref2=this.options.buttons,_j=0,_len1=_ref2.length;_len1>_j;_j++)cfg=_ref2[_j],button=createFromHTML("<li><a class='shepherd-button "+(null!=(_ref3=cfg.classes)?_ref3:"")+"'>"+cfg.text+"</a>"),buttons.appendChild(button),this.bindButtonEvents(cfg,button.querySelector("a"));footer.appendChild(buttons)}return content.appendChild(footer),document.body.appendChild(this.el),this.setupTether(),this.options.advanceOn?this.bindAdvance():void 0},Step.prototype.bindCancelLink=function(link){var _this=this;return link.addEventListener("click",function(e){return e.preventDefault(),_this.cancel()})},Step.prototype.bindButtonEvents=function(cfg,el){var event,handler,page,_ref1,_this=this;null==cfg.events&&(cfg.events={}),null!=cfg.action&&(cfg.events.click=cfg.action),_ref1=cfg.events;for(event in _ref1)handler=_ref1[event],"string"==typeof handler&&(page=handler,handler=function(){return _this.tour.show(page)}),el.addEventListener(event,handler);return this.on("destroy",function(){var _ref2,_results;_ref2=cfg.events,_results=[];for(event in _ref2)handler=_ref2[event],_results.push(el.removeEventListener(event,handler));return _results})},Step}(Evented),Tour=function(_super){function Tour(options){var event,_fn,_i,_len,_ref1,_ref2,_this=this;for(this.options=null!=options?options:{},this.hide=__bind(this.hide,this),this.complete=__bind(this.complete,this),this.cancel=__bind(this.cancel,this),this.back=__bind(this.back,this),this.next=__bind(this.next,this),this.steps=null!=(_ref1=this.options.steps)?_ref1:[],_ref2=["complete","cancel","hide","start","show","active","inactive"],_fn=function(event){return _this.on(event,function(opts){return null==opts&&(opts={}),opts.tour=_this,Shepherd.trigger(event,opts)})},_i=0,_len=_ref2.length;_len>_i;_i++)event=_ref2[_i],_fn(event)}return __extends(Tour,_super),Tour.prototype.addStep=function(name,step){var _ref1;return null==step&&(step=name),step instanceof Step?step.tour=this:(("string"==(_ref1=typeof name)||"number"===_ref1)&&(step.id=name.toString()),step=extend({},this.options.defaults,step),step=new Step(this,step)),this.steps.push(step),step},Tour.prototype.getById=function(id){var step,_i,_len,_ref1;for(_ref1=this.steps,_i=0,_len=_ref1.length;_len>_i;_i++)if(step=_ref1[_i],step.id===id)return step},Tour.prototype.getCurrentStep=function(){return this.currentStep},Tour.prototype.next=function(){var index;return index=this.steps.indexOf(this.currentStep),index===this.steps.length-1?(this.hide(index),this.trigger("complete"),this.done()):this.show(index+1)},Tour.prototype.back=function(){var index;return index=this.steps.indexOf(this.currentStep),this.show(index-1)},Tour.prototype.cancel=function(){var _ref1;return null!=(_ref1=this.currentStep)&&_ref1.hide(),this.trigger("cancel"),this.done()},Tour.prototype.complete=function(){var _ref1;return null!=(_ref1=this.currentStep)&&_ref1.hide(),this.trigger("complete"),this.done()},Tour.prototype.hide=function(){var _ref1;return null!=(_ref1=this.currentStep)&&_ref1.hide(),this.trigger("hide"),this.done()},Tour.prototype.done=function(){return Shepherd.activeTour=null,removeClass(document.body,"shepherd-active"),this.trigger("inactive",{tour:this})},Tour.prototype.show=function(key){var next;return null==key&&(key=0),this.currentStep?this.currentStep.hide():(addClass(document.body,"shepherd-active"),this.trigger("active",{tour:this})),Shepherd.activeTour=this,next="string"==typeof key?this.getById(key):this.steps[key],next?(this.trigger("show",{step:next,previous:this.currentStep}),this.currentStep=next,next.show()):void 0},Tour.prototype.start=function(){return this.trigger("start"),this.currentStep=null,this.next()},Tour}(Evented),extend(Shepherd,{Tour:Tour,Step:Step,Evented:Evented}),window.Shepherd=Shepherd}.call(this);