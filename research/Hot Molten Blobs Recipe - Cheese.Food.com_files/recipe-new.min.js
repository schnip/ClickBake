"undefined"!=typeof jQuery&&function($){function Stuck(element,options){if(element){var defaults={threshholdTarget:element.parent(),fixedPosition:{top:100,marginTop:0,marginBottom:0},respectBottomThreshhold:!1,isActive:function(){var vp=FD.viewports.viewport();return"md"==vp.name||"lg"==vp.name}};return this.element=element.jquery?element:$(element),this.settings=$.extend({},defaults,options||{}),this.init(),this.id=options.id||FD.Page.getUniqueId(),this}return new Error("No element for $.fn.stuck() to stick.")}var pluginName="stuck";Stuck.prototype.init=function(options){var self=this;options&&$.extend(this.settings,options),self.offset=self.element.offset(),self.position=self.element.position(),$(window).one("resize",function(e){self.resize()}),self.listenForScroll()},Stuck.prototype.getThreshhold=function(scrollData,fixedPosition){var self=this,settings=self.settings,elementOffset=self.offset,target=settings.threshholdTarget,marginBottom=settings.fixedPosition.marginBottom||0,threshhold={top:target.offset().top-fixedPosition.top,left:elementOffset.left+scrollData.viewport.left,bottom:target.offset().top+target.height()-self.element.height()-marginBottom};return threshhold},Stuck.prototype.getFixedPosition=function(scrollData){var self=this,settings=self.settings,elementOffset=self.offset,marginLeft=(self.position,self.element.css("marginLeft")||"0"),marginTop=(self.element.css("paddingLeft")||"0",settings.fixedPosition.marginTop||0),fixedPosition={top:settings.fixedPosition.top+marginTop,left:scrollData.viewport.left+elementOffset.left-parseInt(marginLeft,10)};return fixedPosition},Stuck.prototype.setPosition=function(scrollData){var self=this,settings=self.settings,element=this.element,top=(this.offset,settings.target,scrollData.viewport.top),fixedPosition=self.getFixedPosition(scrollData),threshhold=self.getThreshhold(scrollData,fixedPosition),hasStyle=!!element.attr("style"),belowTopThreshhold=threshhold.top-top<=0,aboveBottomThreshold=threshhold.bottom-top>0,withinThreshhold=belowTopThreshhold&&aboveBottomThreshold,isStuckActive=settings.isActive();isStuckActive?settings.respectBottomThreshhold?withinThreshhold?(element.css({position:"fixed",top:fixedPosition.top+"px",left:fixedPosition.left+"px"}),FD.publish("fd.stuck.on",element)):(element.removeAttr("style"),FD.publish("fd.stuck.off",element)):belowTopThreshhold?hasStyle||(element.css({position:"fixed",top:fixedPosition.top+"px",left:fixedPosition.left+"px"}),FD.publish("fd.stuck.on",element)):(element.removeAttr("style"),FD.publish("fd.stuck.off",element)):element.removeAttr("style")},Stuck.prototype.listenForScroll=function(){var self=this;FD.scrollTracker&&FD.subscribe(FD.scrollTracker.eventName,function(data){self.setPosition(data)})},Stuck.prototype.resize=function(){this.element.removeAttr("style"),this.init(),$(window).scroll()},$.fn[pluginName]=function(options){var self=this;return this.each(function(){var element=$(this),isStuck=element.data("fd.stuck"),stuck=isStuck?new Error("stuck already loaded for this element"):new Stuck(element,options);"Error"==typeof stuck?log("Error in fd.stuck plugin",stuck):element.data("fd.stuck",stuck)}),self}}(jQuery),function(){function BasicFeed(options){this.settings=$.extend(!0,{},defaults,options||{});var defaultContainer=$(this.settings.selector.container);this.container=defaultContainer,this.init()}if(!FD.Page.Feed){$(function(){FD.Page.Feed=BasicFeed}),log("**************BasicFeed*********");var defaults={selector:{container:".fd-page-feed"},offset:700,hasOmnitureFired:!1,page:{marker:"data-page-num",urlAttr:"pg",current:null},ajax:{url:null,type:"get",datatype:"json",data:{}},events:{loading:"fd.feed.loading",process:"fd.feed.process",loaded:"fd.feed.loaded",loadError:"fd.feed.loadError"},feedMsg:{selector:".feedMsg",html:'<span class="feedMsg"><span class="icon-fdc-loading fa-spin"></span>Loading...</span>',errorHtml:'<span class="feedMsg"><span class="icon-fdc-error"></span>Sorry, there was an error loading the next item. Please try refreshing your browser.</span>'}};BasicFeed.prototype.offset=function(val){return val&&(this.settings.offset=val),this.settings.offset},BasicFeed.prototype.init=function(){var me=this;me.isLoading=!1,me.settings.page.current=me.settings.page.current||this.getCurrentPageFromUI(),me.checkAjaxData(),this.setupEvents()},BasicFeed.prototype.checkAjaxData=function(){var key,val,me=this,ajax=(me.settings,this.settings.ajax),data=ajax.data;if(data)for(key in data)key.endsWith("s")&&(val=data[key],","==val||"[]"==val?data[key]=[]:val.contains(",")&&(data[key]=val.split(",")))},BasicFeed.prototype.load=function(){var me=this;if(settings=me.settings,ajaxOps=$.extend({},settings.ajax),ajaxOps.data&&(ajaxOps.data.nextrecipeids=ajaxOps.data.nextrecipeids.join(",")),ajaxOps&&ajaxOps.url){var feedMsg=settings.feedMsg;me.isLoading=!0,me.container.append(feedMsg.html),$.ajax(ajaxOps).done(function(results,textStatus,jqXHR){log("ajax"),FD.publish(settings.events.process,[results,function(){FD.publish(settings.events.loaded),me.isLoading=!1}])}).fail(function(){me.container.find(feedMsg.selector).replaceWith(feedMsg.errorHtml),FD.publish(settings.events.loadError)})}},BasicFeed.prototype.setupEvents=function(){var me=this;FD.scrollTracker&&FD.subscribe(FD.scrollTracker.eventName,function(scrollData){me.infiniteScroll(scrollData)})},BasicFeed.prototype.infiniteScroll=function(scrollData){var me=this,settings=me.settings,position=scrollData.position;me.hasReachedThreshold(position)&&!me.isLoading&&me.load(),me.isNewPage()&&(me.updateUrlState(),log("::Event Published: New Page:::"),FD.publish("fd.feed.page.changed"),settings.hasOmnitureFired||(FD.publish("fd.omniture.pageview.fire"),settings.hasOmnitureFired=!0))},BasicFeed.prototype.updateUrlState=function(){var url=this.getPushUrl();FD.History.replace({},FD.Page.title(),url.toString())},BasicFeed.prototype.getPushUrl=function(){var page=this.settings.page,url=new FD.Url;return url.querystring.val(page.urlAttr,page.current),url},BasicFeed.prototype.getCurrentPageFromUI=function(){var pageMarker=this.settings.page.marker,scrollPos=$(window).scrollTop(),viewportHeight=$(window).height(),visiblePages=$("["+pageMarker+"]").filter(function(){var pageTop=$(this).position().top;return viewportHeight+scrollPos>pageTop});return visiblePages.last().attr(pageMarker)},BasicFeed.prototype.isNewPage=function(){var me=this,currentPage=me.getCurrentPageFromUI(),lastPage=me.settings.page.current;return me.settings.page.current=currentPage,lastPage!=currentPage},BasicFeed.prototype.hasReachedThreshold=function(scrollTop){var container=this.container,containerBottom=Math.floor(container.position().top)+container.outerHeight();return viewportHeight=$(window).height(),scrollTop+viewportHeight>=containerBottom-this.settings.offset}}}(),"undefined"==typeof FD.Page.RecipeFeed&&(log("** RECIPE FEED **"),$(function(){var urlNextRecipe=new FD.Url(location.origin+"/next-recipe.do?rid=&nextrecipeids=,&nrf=true"),options={page:{marker:"data-page-name"},ajax:urlNextRecipe.ajaxGet()},rf=FD.Page.RecipeFeed=new FD.Page.Feed(options);FD.subscribe(rf.settings.events.process,function(results,fn){var settings=rf.settings,feedMsg=settings.feedMsg;rf.container.find(feedMsg.selector).replaceWith(results),settings.hasOmnitureFired=!1,fn&&"function"==typeof fn&&fn()}),rf.updateNextRecipe=function(){log("++++ NEXTRECIPEID");var ajaxData=this.settings.ajax.data;Array.isArray(ajaxData.nextrecipeids)||(ajaxData.nextrecipeids=ajaxData.nextrecipeids.split(",")),ajaxData.nextrecipeids.push(ajaxData.rid),ajaxData.rid=$("[data-next-recipe-id]:last").data("nextRecipeId")},rf.updateUrlState=function(){var me=this,url=this.getPushUrl();FD.History.replace({currentPage:me.settings.page.current},FD.Page.title(),url.toString())},rf.getPushUrl=function(){log("++++ RECIPE FEED: getPushUrl");var currentPage=this.settings.page.current,url=new FD.Url,path=url.path,regExRecipePath=/\/recipe\/(\w|\-)+\/*$/;return url.path=path.replace(regExRecipePath,currentPage),url.querystring.val("photo",null),url.toString(!0)},rf.initRF=function(){log("init update");var me=this,ajaxData=me.settings.ajax.data,currentId=FD.Page.Recipe.current.id,$currentRecipe=$("#"+currentId),$nextRecipeLink=$currentRecipe.find("[data-next-recipe-id]");$nextRecipeLink.length>0?(ajaxData.nextrecipeids=[currentId],ajaxData.rid=$nextRecipeLink.data("nextRecipeId")):this.settings.ajax=null},$(document).on("click","a[data-next-recipe-id]",function(e){var $target=$(e.target),$thisRecipe=$target.closest("["+rf.settings.page.marker+"]"),curPageBottom=$thisRecipe.offset().top+$thisRecipe.height(),nextRecipeId=$(this).data("nextRecipeId"),nextRecipeExists=$("#"+nextRecipeId).length>0,viewPortSize=FD.viewports.viewport().name;return e.preventDefault(),nextRecipeExists||(rf.lateSkip=curPageBottom,rf.isLoading||rf.load()),"xs"===viewPortSize||"sm"==viewPortSize?(FD.viewports.dfpLoader({renderOutOfView:!0}),setTimeout(function(){$(window).scrollTop(curPageBottom-350),setTimeout(function(){curPageBottom=$thisRecipe.offset().top+$thisRecipe.height(),$("html,body").animate({scrollTop:curPageBottom},3e3,"swing")},3e3)},3e3)):$(window).scrollTop(curPageBottom),!1}),FD.subscribe("fd.feed.page.changed",function(){var currentPage=(rf.getPushUrl(),rf.settings.page.current),selector="["+rf.settings.page.marker+'="'+currentPage+'"]',id=$(selector).data("recipe-id");log(rf.settings.page.current),log(FD.Page.Recipe.id),FD.Page.Recipe.id=id,FD.Page.Recipe.setCurrentRecipe(FD.Page.Recipe.recipes[id]),FD.Page.title(FD.Page.Recipe.mdManager.Title)}),FD.subscribe(rf.settings.events.loaded,function(){var me=rf,imgSelector=(me.settings.ajax.data.rid,"article["+me.settings.page.marker+"]:last ul.slides li img");me.lateSkip&&(log("publish late skip"),$(window).scrollTop(me.lateSkip),delete me.lateSkip),me.updateNextRecipe(),$(imgSelector).each(function(){var $t=$(this),imgUrl=$t.data("src"),src=$t.attr("src");src||$t.attr("src",imgUrl)})}),FD.subscribe("History.statechange",function(state){var pageTop,currentPage=state.data.currentPage,recipeSelector="["+rf.settings.page.marker+'="'+currentPage+"]";currentPage&&(log("try to scroll to top and preventDefault"),event.preventDefault(),event.stopPropagation(),event.stopImmediatePropagation(),pageTop=$(recipeSelector).offset().top,$(window).scrollTop(pageTop),log(pageTop))})})),log("Recipe Page JS"),function($){log("...Starting Execution (Recipe Page JS");var recipe={Recipe:{id:0,url:"",shortUrl:"",mdManager:{},social:{facebook:"https://www.facebook.com/sharer/sharer.php?display=popup",pinterest:"http://pinterest.com/pin/create/button/?url={{url}}&media={{media}}&description={{description}}",gplus:"https://plus.google.com/share?url={{url}}",twitter:'http://twitter.com/share?text={{text}}&url={{url}}"'},picList:{},recipes:{},sailthruTag:'meta[name="sailthru.tags"]',showBuyButton:!1,init:function(options){var me=this;log("starting the FD.Page.Recipe.init() Method..."),me.setCurrentRecipe(options),me.actions.initActions(),FD.Page.RecipeFeed.initRF(),FD.subscribe("fd.feed.page.changed",function(){"undefined"!=typeof OBR&&"undefined"!=typeof OBR.extern&&OBR.extern.researchWidget()})},setNext:function(recipeInfo){var me=this;me.setCurrentRecipe(recipeInfo,!1)},setCurrentRecipe:function(recipeInfo,changeCurrent){var me=this,$directions=$(".recipe-detail .directions ol"),viewport=FD.viewports.viewport();"undefined"==typeof changeCurrent&&(changeCurrent=!0),$(".review-content .reviews article p").visualTruncator(),"xs"===viewport.name?($directions.visualTruncator(),$directions.on("expand",function(e){console.log("...event: expanding!"),SNI.Analytics.moduleTrackLS(e,{ModuleName:"recipeDirections",LinkTitle:"expand",LocUrl:document.location.href,LinkPosition:"top",TargetUrl:"on page interaction"})})):$directions.addClass("expanded"),$directions.on("click",function(){var $self=$(this);$self.closest(".directions").addClass("directions-expanded")}),recipeInfo.mdManager.DeliveryChannel=FD.viewports.viewport().label,me.recipes[recipeInfo.id]=recipeInfo,changeCurrent&&(me.current=recipeInfo),me.setMDManagerData(recipeInfo.mdManager),FD.Page.Recipe.actions.loadShortUrl(recipeInfo),$(FD.Page.Recipe.sailthruTag).attr("content",recipeInfo.mdManager.keywords),FD.Session.onReady(function(){me.setRecipeBox()}),$("article").removeClass("current").filter('[id="'+recipeInfo.id+'"]').addClass("current"),this.stickyAd(),FD.publish("fd.recipe.setcurrentrecipe",[recipeInfo])},setRecipeBox:function(){var me=this,id=me.current.id;FD.Session.isSignedIn()&&(FD.RecipeBox.display.isInAFolder(id),FD.RecipeBox.display.isInTheGroceryList(id),FD.RecipeBox.display.getPrivateNote(id))},setMDManagerData:function(mdManagerValues){var key;for(key in mdManagerValues)mdManager.setParameter(key,mdManagerValues[key])},actions:{showBuyButton:function(){FD.Page.Recipe.showBuyButton=!0;var currentRecipeId=FD.Page.Recipe.current.id;if(currentRecipeId.indexOf(".")>0)var ingredientExtraContainer=$(".ingredients .extras"),ingredientItems=$(".ingredients .extras"),ingredientItemsString=$(ingredientItems).html(),formNameRecipeId=currentRecipeId.replace(".","");else var ingredientExtraContainer=$("#"+currentRecipeId+".current .ingredients .extras"),ingredientItems=$("#"+currentRecipeId+".current .ingredients .extras"),ingredientItemsString=$(ingredientItems).html(),formNameRecipeId=currentRecipeId.replace(".","");0===$("form[name=buyAtWalmart-"+formNameRecipeId+"]").length&&ingredientExtraContainer.append('<form name="buyAtWalmart-'+formNameRecipeId+'" action="'+FD.Config.serverURL+'/prototype/walmart/submit" method="POST" target="_blank">'+ingredientItemsString+"</form><div onClick=\"$('form[name=buyAtWalmart-"+formNameRecipeId+']\').submit();" class="btn-walmart-container"><img class="btn-walmart" src="'+FD.Config.imgServerURL+'/fdc/img/sponsor/FDC-buyAtWalmartButton.svg" alt="Buy at Walmart Grocery"></div></form>')},share:function(){var shareOn=this;return function(e){var target=$(e.target),link="a"==target[0].nodeName?target:target.closest("a"),network=link.data("network"),recipe=target.parents("[data-recipe-id]").first(),id=recipe.data("recipeId"),recipeInfo=id&&FD.Page.Recipe.recipes[id],isVideoShare=link.data("videoShare");if(e.preventDefault(),isVideoShare){var vid=FD.Video.Player.currentVideo;shareOn[network](vid.seoUrl,vid.imageUrl4x3,vid.title)}else id?shareOn[network](recipeInfo.url,recipeInfo.share.imageUrl,recipeInfo.share.title):console.log("**** unable to share recipe ("+id+") on "+network+" ****")}},facebook:function(url){var urlObject=(FD.Config.IS.FB.id,new FD.Url(url));urlObject.querystring.val("soc","socialsharingfb"),url=encodeURIComponent(urlObject.toString()),fbShareUrl=FD.Page.Recipe.social.facebook+"&u="+url,window.open(fbShareUrl)},pinterest:function(url,imageUrl,title){var media=encodeURIComponent(imageUrl),descr=encodeURIComponent($("<div/>").html(title).text()),urlObject=new FD.Url(url);urlObject.querystring.val("soc","socialsharingpinterest"),url=encodeURIComponent(urlObject.toString()),window.open(FD.Page.Recipe.social.pinterest.replace("{{url}}",url).replace("{{media}}",media).replace("{{description}}",descr))},twitter:function(url,imageUrl,title){var urlObject=new FD.Url(url);urlObject.querystring.val("soc","socialsharingtw"),text=encodeURIComponent($("<div/>").html(title).text()+" "+urlObject.toString()+" via @fooddotcom"),window.open(FD.Page.Recipe.social.twitter.replace("{{url}}",urlObject.toString()).replace("{{text}}",text))},gplus:function(url){var urlObject=new FD.Url(url);urlObject.querystring.val("soc","socialsharinggplus"),window.open(FD.Page.Recipe.social.gplus.replace("{{url}}",encodeURIComponent(urlObject.toString())))},sendEmail:function(buttonElem,modalElem){var url,data,button=$(buttonElem),buttonHtml=button.html(),recipeId=button.data("recipe-id");button.html('<i class="icon-fdc-loading fa-spin">'),url=FD.Config.serverURL+"/services/mobile/email/recipe?rid="+recipeId,data={fromemail:$("#fromemail").val(),toemail:$("#toemail").val(),fromname:$("#fromname").val(),msgtext:$("#msgtext").val(),shorturl:FD.Page.Recipe.recipes[recipeId].shortUrl,recaptcha_challenge_field:$("#recaptcha_challenge_field").val(),recaptcha_response_field:$("#recaptcha_response_field").val()},$.ajax({type:"POST",url:url,data:data,dataType:"json",success:function(data){var responseType=data.responseType;"SUCCESS"==responseType?FD.publish("fd.email.send.success",[recipeId]):($(modalElem).find(".modal-error-message").html("Error Sending Message."),Recaptcha.reload()),button.html(buttonHtml)}})},loadShortUrl:function(recipeInfo){var url=recipeInfo.url,recipeId=recipeInfo.id,recipePage=FD.Page.Recipe;FD.Config.useShortUrl?recipePage.recipes[recipeId].shortUrl=url:recipePage.recipes[recipeId].shortUrl=url},selector:{share:".social-share",firstPhoto:".nophoto a[data-su-pick-options],.onephoto i[data-su-pick-options]",recipeBox:"a.rb-open",groceryList:"a.grocery-list"},cssClass:{loading:"icon-fdc-loading fa-spin",groceryListAdd:"icon-fdc-add-to-grocery-list",groceryListRemove:"icon-fdc-remove-from-grocery-list"},events:{photoUploadOpen:"fd.photo-upload.open",groceryListAdd:"fd.recipe-box.grocery-list.add",groceryListRemove:"fd.recipe-box.grocery-list.remove",recipeBoxShow:"fd.recipe-box.folders.show"},initActions:function(){var me=this,cssClass=me.cssClass,selector=me.selector;events=me.events,$(document).on("click",selector.firstPhoto,function(e){FD.publish(events.photoUploadOpen,$(e.currentTarget)),log("Published Event: fd.photo-upload.open")}).on("click",selector.groceryList,function(e){var el=$(e.currentTarget),elIcon=el.find("i");return FD.Session.requireAccount(function(){elIcon.hasClass("icon-fdc-plus")?(elIcon.removeClass("icon-fdc-plus"),elIcon.addClass(cssClass.loading),FD.publish(events.groceryListAdd,el)):elIcon.hasClass("icon-fdc-minus")&&(elIcon.removeClass("icon-fdc-minus"),elIcon.addClass(cssClass.loading),FD.publish(events.groceryListRemove,el))}),!1}).on("click",selector.recipeBox,function(e){return FD.Session.isSignedIn()?(FD.Session.requireAccount(function(){}),FD.publish(events.recipeBoxShow,$(e.currentTarget)),!1):(FD.Session.register(),!1)}).on("click","a.email-open",function(e){var elem=$(e.currentTarget),recipeId=elem.data("recipe-id")||elem.parent().data("recipe-id");return log("opening email: "+recipeId),"xs"!=FD.viewports.viewport().name?($("#"+recipeId+"_share").modal("hide"),$("#email_recipe_title").html(FD.Page.Recipe.recipes[recipeId].share.title),$(".email-send").data("recipe-id",recipeId),$("#email").modal("show"),Recaptcha.create(FD.Config.reCaptcha,"email_captcha",{theme:"clean",callback:Recaptcha.focus_response_field}),!1):void 0}).on("click",".email-send",function(e){var elem=$(e.target);log("sending email: "),FD.Page.Recipe.actions.sendEmail(elem,$("#"+elem.data("modal-id")))}).on("click",".social-share",me.share()).on("click","a.submit-correction",function(e){FD.Session.isSignedIn()||(FD.Session.register(),e.preventDefault())}).on("click","a.write-a-review",function(e){var elem=$(e.target),href=elem.data("href");return FD.Session.isSignedIn()?(document.location.href=href,!1):(FD.Session.register(),!1)}),FD.subscribe("fd.recipe-box.grocery-list.add.success",function(recipeId){log("...added to grocery list"),el=$('.grocery-list[data-recipe-id="'+recipeId+'"]').find("i"),el.removeClass("icon-fdc-loading fa-spin").removeClass("icon-fdc-plus").addClass("icon-fdc-minus"),el.parent().attr("title","Remove From Grocery List"),FD.publish("fd.recipe-box.folders.add.success",[recipeId])}),FD.subscribe("fd.recipe-box.grocery-list.remove.success",function(recipeId){log("...removed to grocery list"),el=$('.grocery-list[data-recipe-id="'+recipeId+'"]').find("i"),el.removeClass("icon-fdc-loading fa-spin").removeClass("icon-fdc-minus").addClass("icon-fdc-plus"),el.parent().attr("title","Add To Grocery List")}),FD.subscribe("fd.recipe-box.folders.add.success",function(recipeId){log("...added to recipe box"),$('.rb-open[data-recipe-id="'+recipeId+'"]').find("i").removeClass("icon-fdc-plus").addClass("icon-fdc-minus")}),FD.subscribe("fd.recipe-box.folders.in-a-folder.true",function(recipeId){log("...already in the recipe box"),$('.rb-open[data-recipe-id="'+recipeId+'"]').find("i").removeClass("icon-fdc-plus").addClass("icon-fdc-minus")}),FD.subscribe("fd.recipe-box.folders.remove.success",function(recipeId){log("...removed from recipe box"),$('.rb-open[data-recipe-id="'+recipeId+'"]').find("i").removeClass("icon-fdc-minus").addClass("icon-fdc-plus")}),FD.subscribe("fd.recipe-box.private-note.show",function(noteText,recipeId){if(log("...show private note ("+recipeId+"): "+noteText),null!==noteText){var privateNoteContainer=".private-note-"+recipeId;$(privateNoteContainer+" .private-note-text").html(noteText),$(privateNoteContainer).removeClass("hidden")}}),FD.subscribe("fd.email.send.success",function(args){var $email=$("#email"),modalBody=$email.find(".modal-body").html();$email.find(".modal-dialog").removeClass("email").end().find(".modal-header").hide().end().find(".modal-footer").hide().end().find(".modal-body").html("<b>Success! Message Sent.</b>").end(),setTimeout(function(){$email.modal("hide"),$email.find(".modal-dialog").addClass("email").end().find(".modal-header").show().end().find(".modal-footer").show().end().find(".modal-body").html(modalBody).find("input").val("").end()},5e3)})}}}};recipe.Recipe.stickyAd=function(){var recipe=this,adContainer=(FD.viewports.viewport(),$("article.current aside.fd-ad"));adContainer.stuck({respectBottomThreshhold:!0,threshholdTarget:$("article.current .recipe-detail"),fixedPosition:{id:recipe.current.id,top:$(".fd-header-wrap").height(),marginTop:14,marginBottom:104}})},"undefined"==typeof FD&&(FD={}),"undefined"==typeof FD.Page&&(FD.Page={}),FD.Page=$.extend(!0,FD.Page,recipe),$(function(){function onePhotoLoad(){var img=$(this);img.siblings(".img-overlay").width(img.width())}function onePhotoError(){$(this).parents(".jumbotron").addClass("nophoto")}log("...DOM Ready (Recipe Page JS"),$(".review-content .reviews article p").visualTruncator();var screenSize=FD.viewports&&FD.viewports.viewport()&&FD.viewports.viewport().name||"";log("screenSize:"+screenSize),("md"===screenSize||"lg"===screenSize)&&SniAds.Event.subscribe("initComplete",function(slot){log("===== Add Init Complete ====="),FD.Page.Recipe.stickyAd()}),$.lazyLoadImage($(".slideshow .onephoto img[data-src]").not("img[src]"),onePhotoLoad,onePhotoError),FD.subscribe("fd.feed.loaded",function(){$.lazyLoadImage($(".slideshow .onephoto img[data-src]").not("img[src]"),onePhotoLoad,onePhotoError)})}),FD.Page.tour=FD.Page.tour||{},FD.Page.tour.buffer=200,FD.Page.tour.enabled=!0,FD.Page.tour.initialized=!1,FD.Page.tour.ready=!1,FD.Page.tour.init=function(){function tourOmniture(eventData,ops){log("---------------------"),log("Send Omniture Data:");var btn=$(eventData.target),label=btn.text()||"no label",pos=btn.parents(".shepherd-element").data("id");"cancel"==ops&&(label="cancel"),log("ModuleName: Recipe Tutorial"),log("LinkTitle: "+label),log("LinkUrl: "+document.location.href),log("LinkPosition: "+pos),log("TargetUrl: on page interaction"),SNI.Analytics.moduleTrackLS(eventData,{ModuleName:"Recipe Tutorial",LinkTitle:label,LocUrl:document.location.href,LinkPosition:pos,TargetUrl:"on page interaction"})}function OutsideTourClick(e){var clickedOutsideTour=0===$(e.target).parents(".shepherd-step").length;clickedOutsideTour&&($(".shepherd-cancel-link")[0].click(),$(document).off("click",OutsideTourClick))}if(FD.Page.tour.initialized===!1&&FD.Page.tour.enabled===!0){FD.Page.tour.initialized=!0,$(document).on("click",".shepherd-button",function(e){log("clicked tour btn"),tourOmniture(e)}),$(document).on("click",".shepherd-cancel-link",function(e){log("clicked tour cancel"),tourOmniture(e,"cancel")});var tourCookieName="prodTour_recipe",tourCookie=$.cookie(tourCookieName),posRBicons="right",posSkip="bottom",viewport=FD.viewports.viewport().name;if("cancelled"===tourCookie)return 0;if("xs"===viewport)return 0;"sm"===viewport&&(posSkip="left"),Shepherd.on("show",function(e){if(log("Tour.show"),e&&e.previous){var scrollLoc,targetOps=e.step.options.attachTo,target=targetOps&&targetOps.element;target&&(scrollLoc=$(target).offset().top-FD.Page.tour.buffer,$("html,body").animate({scrollTop:scrollLoc},3e3,"swing")),"step-3"==e.previous.id&&"step-4"==e.step.id&&$(".recipe-skip a:first").trigger("click")}}),Shepherd.on("cancel",function(){log("Tour.cancel"),$.cookie(tourCookieName,"cancelled",{expires:365,path:"/",domain:FD.Config.cookieDomain})}),tour=new Shepherd.Tour({defaults:{classes:"shepherd-theme-arrows",scrollTo:!1,tetherOptions:{constraints:[{to:"scrollParent",attachment:"together"}]}}}),tour.options.defaults.buttons=[{text:"Back",classes:"shepherd-button-secondary",action:tour.back},{text:"Next",action:tour.next,classes:"shepherd-button-example-primary"}],tour.addStep("step-1",{text:"A few tips: <br/>Save your favorite recipes to Recipe Box here.",attachTo:{element:".rb-open",on:posRBicons},showCancelLink:!0,buttons:[{text:"Exit",classes:"shepherd-button-secondary",action:tour.cancel},{text:"Next",action:tour.next,classes:"shepherd-button-example-primary"}]}),tour.addStep("step-2",{showCancelLink:!0,scrollTo:!1,text:"Add ingredients to your grocery list here.",attachTo:{element:".grocery-list",on:posRBicons}}),tour.addStep("step-3",{scrollTo:!1,showCancelLink:!0,text:"Not what you’re looking for? Skip to the next recipe here.",attachTo:{element:".recipe-skip a",on:posSkip},buttons:[{text:"Back",classes:"shepherd-button-secondary",action:tour.back},{text:"Try",action:tour.next,classes:"shepherd-button-example-primary"}]}),tour.addStep("step-4",{showCancelLink:!0,text:"Great job! Have fun exploring the new Food.com",buttons:[{text:"Back",classes:"shepherd-button-secondary",action:tour.back},{text:"Done",action:tour.cancel,classes:"shepherd-button-example-primary"}]}),tour.start(),$(document).on("click",OutsideTourClick)}},FD.Page.tour.start=function(){FD.Page.tour.ready?FD.Page.tour.load():SniAds.Event.subscribe("slotRenderComplete",function(slot){var adType=FD.Page.getAdType(slot),leaderBoardIsLoaded=adType.startsWith("dfp_leaderboard");log("Ad Slot Complete - "+(adType||"unknown-ad")),leaderBoardIsLoaded&&(FD.Page.tour.ready=!0,FD.Page.tour.load())})},FD.Page.tour.load=function(){url=new FD.Url,key=url.querystring.val("tour"),tourForce=!!key&&"force"==key,tourClear=!!key&&"clear"==key,(tourForce||tourClear)&&$.removeCookie("prodTour_recipe"),(tourForce||FD.Page.tour.enabled)&&FD.Page.tour.init()},$(function(){SniAds.Event.subscribe("slotRenderComplete",function(slot){var adType=FD.Page.getAdType(slot),leaderBoardIsLoaded=adType.startsWith("dfp_leaderboard");log("Ad Slot Complete - "+(adType||"unknown-ad")),leaderBoardIsLoaded&&(FD.Page.tour.ready=!0)})})}(jQuery),function(){"use strict";function resolveDefs(c,block,def){return("string"==typeof block?block:block.toString()).replace(c.define||skip,function(m,code,assign,value){return 0===code.indexOf("def.")&&(code=code.substring(4)),code in def||(":"===assign?(c.defineParams&&value.replace(c.defineParams,function(m,param,v){def[code]={arg:param,text:v}}),code in def||(def[code]=value)):new Function("def","def['"+code+"']="+value)(def)),""}).replace(c.use||skip,function(m,code){c.useParams&&(code=code.replace(c.useParams,function(m,s,d,param){if(def[d]&&def[d].arg&&param){var rw=(d+":"+param).replace(/'|\\/g,"_");return def.__exp=def.__exp||{},def.__exp[rw]=def[d].text.replace(new RegExp("(^|[^\\w$])"+def[d].arg+"([^\\w$])","g"),"$1"+param+"$2"),s+"def.__exp['"+rw+"']"}}));var v=new Function("def","return "+code)(def);return v?resolveDefs(c,v,def):v})}function unescape(code){return code.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var _globals,doT={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};doT.encodeHTMLSource=function(doNotSkipEncoded){var encodeHTMLRules={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},matchHTML=doNotSkipEncoded?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(code){return code?code.toString().replace(matchHTML,function(m){return encodeHTMLRules[m]||m}):""}},_globals=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=doT:"function"==typeof define&&define.amd?define(function(){return doT}):_globals.doT=doT;var startend={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},skip=/$^/;doT.template=function(tmpl,c,def){c=c||doT.templateSettings;var needhtmlencode,indv,cse=c.append?startend.append:startend.split,sid=0,str=c.use||c.define?resolveDefs(c,tmpl,def||{}):tmpl;str=("var out='"+(c.strip?str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):str).replace(/'|\\/g,"\\$&").replace(c.interpolate||skip,function(m,code){return cse.start+unescape(code)+cse.end}).replace(c.encode||skip,function(m,code){return needhtmlencode=!0,cse.startencode+unescape(code)+cse.end}).replace(c.conditional||skip,function(m,elsecase,code){return elsecase?code?"';}else if("+unescape(code)+"){out+='":"';}else{out+='":code?"';if("+unescape(code)+"){out+='":"';}out+='"}).replace(c.iterate||skip,function(m,iterate,vname,iname){return iterate?(sid+=1,indv=iname||"i"+sid,iterate=unescape(iterate),"';var arr"+sid+"="+iterate+";if(arr"+sid+"){var "+vname+","+indv+"=-1,l"+sid+"=arr"+sid+".length-1;while("+indv+"<l"+sid+"){"+vname+"=arr"+sid+"["+indv+"+=1];out+='"):"';} } out+='"}).replace(c.evaluate||skip,function(m,code){return"';"+unescape(code)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),needhtmlencode&&(c.selfcontained||!_globals||_globals._encodeHTML||(_globals._encodeHTML=doT.encodeHTMLSource(c.doNotSkipEncoded)),str="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+doT.encodeHTMLSource.toString()+"("+(c.doNotSkipEncoded||"")+"));"+str);try{return new Function(c.varname,str)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+str),e}},doT.compile=function(tmpl,def){return doT.template(tmpl,null,def)}}();